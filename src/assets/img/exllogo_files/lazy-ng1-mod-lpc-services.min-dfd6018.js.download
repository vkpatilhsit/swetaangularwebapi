 if (typeof __JSWRAPPER === 'undefined' || (!__JSWRAPPER.initialized())) {
     if ((typeof ServiceWorkerContainer !== 'undefined' && self instanceof ServiceWorkerContainer) || (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)) {
         importScripts('https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=11394&type=WORKER&McasTsid=11394&sessionId=cb2e41a1-4f9c-3e62-6b1e-a0bf8af729a8&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin));
     } else {
         eval(function () {
             var x = (typeof __caac__ !== "undefined" && typeof __caac__.xhr !== "undefined") ? new __caac__.xhr() : new XMLHttpRequest();
             x.open = (typeof __caac__ !== "undefined" && typeof __caac__.xhro !== "undefined") ? __caac__.xhro : x.open;
             x.send = (typeof __caac__ !== "undefined" && typeof __caac__.xhrs !== "undefined") ? __caac__.xhrs : x.send;
             x.open('GET', 'https://mcas-proxyweb.mcas.ms/js-bootstrap.js?saasId=11394&type=WINDOW&McasTsid=11394&sessionId=cb2e41a1-4f9c-3e62-6b1e-a0bf8af729a8&origin=' + encodeURIComponent(self.origin ? self.origin : location.origin), false);
             x.withCredentials = true;
             x.send();
             return x.responseText;
         }());
     }
}webpackJsonp([23],{142:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e);});}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){e.done?n(e.value):i(e.value).then(a,s);}c((r=r.apply(e,t||[])).next());});},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t]);};}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue;}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break;}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break;}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break;}a[2]&&c.ops.pop(),c.trys.pop();continue;}n=t.call(e,c);}catch(e){n=[6,e],o=0;}finally{i=a=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1];},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(s,Symbol.iterator,'=',function(){return this;}),s;};Object.defineProperty(t,"__esModule",{value:!0}),t.determineLPCPersonaType=function(e,t){var n=e.type||e.userType;if(!n)return"NotResolved";switch(n){case t.userTypes.federated:case t.userTypes.skypeConsumer:case t.userTypes.tflConsumer:return"External";case"person":return e.role===t.userTypes.guest?"NotResolved":"User";default:return"User";}},t.determineCardTypeForTargetUser=function(e,t,n,r,i){if(n)return"Me";if(r)return"External";switch(t){case i.userTypes.federated:case i.userTypes.skypeConsumer:case i.userTypes.tflConsumer:return"External";case"person":case"ADUser":return"Guest"===e?"Guest":"User";default:return"User";}},t.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e;},t.serializeHostAppPersonaId=function(e){return JSON.stringify(e);},t.isLinkedInEnabled=function(e,t){return e.valueAsBoolean(t.settings.names.enableLinkedInInLPC);},t.deserializeHostAppPersonaId=function(e){if(!e)return{userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0,isExchangeOnlyContact:!1};var t=JSON.parse(e);return{userId:t.userId,isSharedChannel:!0===t.isSharedChannel,hostTenantId:t.hostTenantId,hostConversationId:t.hostConversationId,isExchangeOnlyContact:!0===t.isExchangeOnlyContact};},t.getTimeFormat=function(e){var t=e.getDateFormatValue("shortTime",!1);return"HH:mm"===t?[t,!0]:[t,!1];},t.resolveMriIfNeeded=function(e,t,n){return r(this,void 0,void 0,function(){var r,o;return i(this,function(i){switch(i.label){case 0:return e.TeamsMri?[2,e.TeamsMri]:(r=e.Upn||e.Smtp)?[4,t.getAllPeopleProfile([r],n,!0,r===e.Smtp)]:[2,void 0];case 1:return 0===(o=i.sent()).length?[2,void 0]:[2,o[0].mri];}});});},t.getLPCPlatform=function(e){return e.isWeb()?"Web":"Desktop";};},2404:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2405);},2405:function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&__WRAPPED_set(e,n,'=',__WRAPPED_get(t,n));})(t,n);};return function(t,n){function r(){this.constructor=t;}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r());};}()),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=__WRAPPED_get(arguments,n);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&__WRAPPED_set(e,i,'=',__WRAPPED_get(t,i));}return e;}).apply(this,arguments);},o=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e);});}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){e.done?n(e.value):i(e.value).then(a,s);}c((r=r.apply(e,t||[])).next());});},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t]);};}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue;}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break;}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break;}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break;}a[2]&&c.ops.pop(),c.trys.pop();continue;}n=t.call(e,c);}catch(e){n=[6,e],o=0;}finally{i=a=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1];},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(s,Symbol.iterator,'=',function(){return this;}),s;};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2406),c=n(34),l=n(142),u=n(2407),d=n(2408),p=n(2409),f=n(2410),h=n(2414),v=(function(e){function t(t,n,r,i,o,a,s,c,l,u,d,p,f,h,v,g,m,y){var b=e.call(this,u)||this;return b.constants=t,b.utilityService=n,b.settingsService=r,b.authenticationService=i,b.sxConfig=o,b.localizationService=a,b.eventingService=s,b.appStateService=c,b.desktopUtilityService=l,b.loggingService=d,b.logger=p,b.actionCallbacks=f,b.dataCallbacks=h,b.telemetryCallbacks=v,b.analyticsService=g,b.analyticsStateService=m,b.$state=y,b.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(b.getTheme(e));},b.initializeOnAppLaunchAndReinit("First Initialize"),b;}return r(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC);},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard);},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService";},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null,this.unbsubscribeFromAppStateChanges&&(this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=null);},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,n){t.isLivePersonaCardInitialized&&t.changeTheme(n);}),this.unbsubscribeFromAppStateChanges&&this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=this.eventingService.unsafeOnWithTenantScope(this.constants.events.appState.changed,function(e,n){t.onAppStateChanged(n);});},t.prototype.initializeLPC=function(){return o(this,void 0,void 0,function(){var e,t,n,r,o,c,u,d,p,f,h,v,g,m,y,b,C,S,P,w,T,k,A,I,L,O,E,U,x,M,D,F,B,_,R,N,G,H,j;return a(this,function(a){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];if(e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),n=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,o=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment),c=this.authenticationService.getUserTypeInTenant(),u=this.sxConfig.getCurrentSkypeMri(),d=c===teamspace.services.UserTypeInTenant.Guest,p=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTimeZoneInLPC),f=this.settingsService.valueAsBoolean(this.constants.settings.names.enableExpandedViewInLPC),h=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePronounsInLPC),v=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePeopleHighlightsInLPC),g=this.settingsService.valueAsBoolean(this.constants.settings.names.enableVivaSalesInLPC),m=this.settingsService.valueAsBoolean(this.constants.settings.names.enableNextAvailabilityInLPC),y=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTrustedTypesForLPC),b=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAliasVisibilitySettings),C=l.isLinkedInEnabled(this.settingsService,this.constants),S=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAnonymousUsersInLPC),P=this.settingsService.valueAsBoolean(this.constants.settings.names.enableExtendedDirectory),w=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePresenceInContactInLPC),T=this.settingsService.valueAsBoolean(this.constants.settings.names.enableHybridLocationInLPC),k=this.settingsService.valueAsBoolean(this.constants.settings.names.enableRichAvailabilityPanelInLPC),A=this.settingsService.valueAsBoolean(this.constants.settings.names.enableWorkingHoursInLPC),I=this.constants.settings.names.lpcRegion,L=this.settingsService.valueFor(I),O=!d&&L,E=O?L:"",!window)throw j="Window object is undefined",e.fail({message:j,clientCorrelationId:t,lpcRegion:E,userTypeInTenant:c}),new Error(j);if(!this.appStateService.isOnline)throw j="App is Offline",e.fail({message:j,clientCorrelationId:t,lpcRegion:E,userTypeInTenant:c}),new Error(j);U=this.getTeamsConfig(t,n,E,o),x=this.settingsService.getRing(),M=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCardV2),D={isLivePersonaCardV2Enabled:M},F=l.getTimeFormat(this.localizationService),B=F[0],_=F[1],this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return R=x&&x.id?x.id:void 0,N=r,G=l.getLPCPlatform(this.desktopUtilityService),this.lpcPromise=s.initializeLivePersonaCardAsync(i(i({},U),{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,telemetryCallbacks:this.telemetryCallbacks,getAuthToken:this.getAuthToken(t),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n);},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:R,hostAppVersion:N,platform:G,options:{hostAppRing:R,hostAppVersion:N,isLoggedInAsTeamsGuestUser:d,isTimeZoneEnabled:p,isNavigateToExpandedViewEnabled:f,isPronounsEnabled:h,isPeopleHighlightsEnabled:v,isVivaSalesLpcEnabled:g,isNextAvailabilityEnabled:m,isPresenceInContactEnabled:w,isAliasVisibilityEnabled:b,isLinkedInEnabledInHostApp:C,isAnonymousUsersEnabled:S,isExtendedDirectoryEnabled:P,isHybridLocationEnabled:T,isRichAvailabilityPanelEnabled:k,isWorkingHoursEnabledLPCv2:A,is24HourFormat:_,timeFormat:B,isTrustedTypesEnabled:y},hostAppConfiguration:D,loggedInUserTeamsMri:u,targetWindow:window})),H=M?"LPCv2":"LPCv1",this.lpcPromise.then(function(){var n=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:n,clientCorrelationId:t,lpcRegion:E,userTypeInTenant:c,lpcArchitectureVersion:H});}).catch(function(n){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:t,lpcRegion:E,userTypeInTenant:c,lpcArchitectureVersion:H}),n;}),[2,this.lpcPromise];}catch(n){throw j="Could not load live persona card: "+n,e.fail({message:j,clientCorrelationId:t,lpcRegion:E,userTypeInTenant:c}),new Error(j);}return[2];});});},t.prototype.createLPC=function(e,t){var n=t.profile,r=t.behavior,o=t.ariaLabel,a=t.externalAppSessionCorrelationId,s=t.disableAccessibilityDefaults,c=t.tabIndex,u=t.clientScenario,d=t.isSharedChannel,p=t.hostTenantId,f=t.hostConversationId,h=t.isExchangeOnlyContact,v=t.contactId;{if(this.isLivePersonaCardInitialized){var g=l.determineLPCPersonaType(n,this.constants),m=l.getCleanUpn(n.userPrincipalName),y={personaInfo:{identifiers:{PersonaType:g,AadObjectId:n.objectId,TeamsMri:n.mri,OlsPersonaId:v,HostAppPersonaId:l.serializeHostAppPersonaId({userId:n.mri,isSharedChannel:d,hostTenantId:p,hostConversationId:f,isExchangeOnlyContact:h}),Upn:m,Smtp:n.email},skypeId:n.skypeId},behavior:i({disableHover:!1,cardPlacementMode:"AnchorSide"},r),ariaLabel:o,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:a,clientScenario:u};this.attachHoverTargetAsync(e,y);var b=function(){window.requestIdleCallback&&window.requestIdleCallback(function(){window.LPC&&window.LPC.removedPersonaFromPage(e);});}.bind(this);return{destroy:function(){b();}};}this.logger.error("Not initialized");}},t.prototype.openCard=function(e,t,n,r,s){var c=this;if(this.isLivePersonaCardInitialized){var l=this.utilityService.generateUUID(),u={openCardTriggerType:t,personaInfo:{displayName:n.displayName,identifiers:i({PersonaType:"NotResolved"},n.identifiers)},behavior:{locationToOpen:r,cardPlacementMode:"AnchorSide",onCardOpen:function(){return o(c,void 0,void 0,function(){var e,t;return a(this,function(n){return s&&s.onCardOpen&&s.onCardOpen(),e=this.analyticsStateService.getPreviousRoute(),t={panel:{type:__WRAPPED_get(teamspace.PanelType,teamspace.PanelType.livePersonaCard),region:__WRAPPED_get(teamspace.PanelRegion,teamspace.PanelRegion.popover),viewId:this.utilityService.generateUUID(),uri:this.$state.current.name,previousUri:e&&e.state?e.state.name:void 0}},this.analyticsService.sendPanelView(t),[2];});});},onCardClose:function(){s&&s.onCardClose&&s.onCardClose();var e=c.analyticsStateService.getPreviousRoute(),t={panel:{type:__WRAPPED_get(teamspace.PanelType,teamspace.PanelType.livePersonaCard),region:__WRAPPED_get(teamspace.PanelRegion,teamspace.PanelRegion.popover),viewId:c.utilityService.generateUUID(),uri:c.$state.current.name,previousUri:e&&e.state?e.state.name:void 0},action:{gesture:__WRAPPED_get(teamspace.components.PanelActionGesture,teamspace.components.PanelActionGesture.hover),outcome:__WRAPPED_get(teamspace.components.PanelActionOutcome,teamspace.components.PanelActionOutcome.closeDialog),scenario:teamspace.components.PanelActionScenario.livePersonaCard,scenarioType:teamspace.components.PanelActionScenarioType.people},module:{name:teamspace.components.PanelModuleName.personCard.toString(),type:__WRAPPED_get(teamspace.components.PanelModuleType,teamspace.components.PanelModuleType.other)}};c.analyticsService.sendPanelAction(t);}},externalAppSessionCorrelationId:l};window.LPC.openCard(e,u);}else this.logger.error("Not initialized");},t.prototype.onAppStateChanged=function(e){var t=e.prevState,n=t===teamspace.services.ApplicationState.Offline||t===teamspace.services.ApplicationState.Disconnected||t===teamspace.services.ApplicationState.Disabled,r=this.appStateService.isOnline&&n,i=this.settingsService.valueAsBoolean(this.constants.settings.names.disableLpcOnlineRecovery);r&&!i&&!this.isLivePersonaCardInitialized&&window?(s.freeBootstrapperMemory(window),this.initializeLPC()):this.logger.info("onAppStateChanged: Skip initializeLPC(). isBackOnlineAfterBeingOffline = {0}, disableLpcOnlineRecovery = {1}, this.isLivePersonaCardInitialized = {2}",r,i,this.isLivePersonaCardInitialized);},t.prototype.attachHoverTargetAsync=function(e,t){window.LPC.addedPersonaToPageV2(e,t);},t.prototype.getTheme=function(e){switch(e){case c.TeamsTheme.Dark:case c.TeamsTheme.DarkV2:return f.darkTheme;case c.TeamsTheme.HighContrast:return f.highContrastTheme;case c.TeamsTheme.Default:case c.TeamsTheme.DefaultV2:default:return f.defaultTheme;}},t.prototype.getTeamsConfig=function(e,t,n,r){var i=this.authenticationService.isCurrentUserTFLOrMsaAccount();return{culture:t||window.navigator.language||"en-us",region:n,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:r,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1},isConsumer:i};},t.prototype.getAuthToken=function(e){var t=this;return function(n,r){return o(t,void 0,void 0,function(){var t,i,o,s,c,l,u,d,p,f,h,v,g,m,y,b;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=this.constants.settings.names,i=t.lokiTokenResourceUrl,o=t.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(o),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=a.sent())?("string"!=typeof c&&(l=c,u=Boolean(l.token)?"true":"false",this.logger.service.event("lokitoken_format_workaround",{data:"ContainedToken:"+u}),c=null!==(b=l.token)&&void 0!==b?b:""),n(c,e)):r("[AuthError] Error retrieving auth token, details: Empty token",e),[3,3];case 2:return d=a.sent(),this.logger.error("Error acquiring access token for LOKI"),p=!1,f="Unexpected Error",h=void 0,d&&(h=_.isString(d)?d:d.authStatus+"-"+d.message,h=h.toLowerCase()),h&&(v=h.includes("retry fetch of adal tokens"),g=h.includes("nativewam:3")||h.includes("tokenrevoked"),m=h.includes("mt_token_expired")||h.includes("receivedexpiredtoken"),y=h.includes("renewaltimeout")||h.includes("token renewal"),p=v||y||m||g,v?f="Retry fetch of ADAL tokens failed":y?f="Token renewal call timed out":g?f="Token revoked":m&&(f="Token expired")),r("[AuthError] Error retrieving auth token, details: "+f,e,p),[3,3];case 3:return[2];}});});};},t;}(teamspace.services.MTMABase));t.LivePersonaCardService=v,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.dialogService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsAsyncService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService","teamspace.extendedDirectoryOnlyPolicyService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsAsyncService","localizationService","eventingService","messageService","peopleService","dialogService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService","callBlockingService","appStateService","desktopUtilityService","sxConfig","routeUtilityService","messagingPolicyUtilsService","flatContactListService","telemetryProvider","chatListService","tenantSettingsStore","extendedDirectoryOnlyPolicyService","analyticsStateService","$state",function(e,t,n,r,i,o,a,s,c,l,f,g,m,y,b,C,S,P,w,T,k,A,I,L,O,E,U,x,M,D,F,B,_,R,N,G,H,j,V,X){var z=o.newLogger("LivePersonaCardService"),W=new h.LpcTelemetryHelper(U,o,l),q=W.logPanelActionEvent.bind(W),Q=a.getUserTypeInTenant(),K=u.LPCActionCallbackFactory(s,e,z,y,l,a,c,C,m,x,b,i,G,q,F),Z=d.LPCDataCallbackFactory(z,l,S,y,r,P,w,i,e,T,k,A,I,L,f,O,x,t,n,Q,F,a,B,_,R,H,j,M),J=i.valueAsBoolean(e.settings.names.enableLpcSecondPartyTelemetry)?p.LPCTelemetryCallbackFactory(N):void 0;return new v(e,r,i,a,F,f,g,M,D,E,o,z,K,Z,J,U,V,X);}]);},2406:function(e,t,n){!(function(t,n){e.exports=n();}(self,function(){return(function(){"use strict";function e(t){var n=__WRAPPED_get(o,t);if(void 0!==n)return n.exports;var r=__WRAPPED_set(o,t,'=',{exports:{}});return __WRAPPED_call(i,t)(r,r.exports,e),r.exports;}var t,n,r,i={682:function(e,t,n){function r(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t);})).then(a,s);}c((r=r.apply(e,t||[])).next());});}function i(e,t){function n(n){return function(a){return(function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue;}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break;}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break;}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break;}o[2]&&s.ops.pop(),s.trys.pop();continue;}n=t.call(e,s);}catch(e){n=[6,e],i=0;}finally{r=o=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}([n,a]));};}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1];},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(a,Symbol.iterator,'=',function(){return this;}),a;}function o(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&__WRAPPED_get(e,t),r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e};}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.");}n.d(t,{Jh:function(){return i;},XA:function(){return o;},mG:function(){return r;},pi:function(){return a;}});var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=__WRAPPED_get(arguments,n))Object.prototype.hasOwnProperty.call(t,i)&&__WRAPPED_set(e,i,'=',__WRAPPED_get(t,i));return e;}).apply(this,arguments);};Object.create,Object.create;},932:function(e,t,n){function r(e){return e;}n.d(t,{k:function(){return r;}});},928:function(e,t,n){function r(e){return!(function(e){return!e||"00000000-0000-0000-0000-000000000000"===e;}(e))&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e||"");}function i(){for(var e=(function(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||(function(){for(var e=new Array(31),t=0;t<31;t++)__WRAPPED_set(e,t,'=',Math.floor(16*Math.random()));return e;}());var e;}()),t=0,n="",r=0;r<36;r++)switch(r){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[r-t]%4+8).toString(16);break;default:n+=(e[r-t]%16).toString(16);}return n;}n.d(t,{pW:function(){return i;},SD:function(){return r;}});},462:function(e,t,n){n.d(t,{e:function(){return r;}});var r="Unknown";},859:function(e,t){t.Z={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"};},471:function(e,t){t.Z={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"};},977:function(e,t,n){function r(e){return o.indexOf(e)>-1;}function i(e){return-1===a.indexOf(e);}n.d(t,{$:function(){return r;},N:function(){return i;}});var o=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],a=["Stikkontakt","DataLoadStartAction","NoLogging","None"];},895:function(e,t,n){var r=n(682),i=n(928),o=n(451),a=n(462),s=n(859),c=n(471),l=n(977),u=(function(){function e(e,t,n,r,o,a,s){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=r,this.staticProperties=o,this.lookupError=a,this.isVerboseLoggingEnabled=s,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=c.Z.MONITOR_IN_INVALID_STATE,this.transactionId=(0,i.pW)(),this.start();}return e.prototype.flush=function(){return this.eventHubPromise.then(function(e){return e.broadcastFlush();});},e.prototype.success=function(e,t){this.endEvent(e,c.Z.SUCCESS,t);},e.prototype.expectedFailure=function(e,t){this.endEvent(e,c.Z.EXPECTED_FAILURE,t);},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,c.Z.UNEXPECTED_FAILURE,t);},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,c.Z.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties);},e.prototype.start=function(){this.startTime=new Date().getTime();},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=new Date().getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=c.Z.MONITOR_IN_INVALID_STATE,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose();},e.prototype.broadcastEvent=function(e,t,n){return(0,r.mG)(this,void 0,void 0,function(){var i,s,c,u,d,p;return(0,r.Jh)(this,function(r){switch(r.label){case 0:return!(0,l.N)(this.featureName)||(0,l.$)(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(i=e?"".concat(this.scenarioName,"_").concat(t,"_").concat(e):"".concat(this.scenarioName,"_").concat(t),[4,this.eventHubPromise]):[3,5];case 1:return s=r.sent(),u=(c=s).broadcastEvent,p={eventId:i,version:this.monitoringData.version?this.monitoringData.version:a.e,type:"QoS"},n&&(0,o.x)(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return d=r.sent(),[3,4];case 3:d=void 0,r.label=4;case 4:u.apply(c,[(p.midgardError=d,p.source=this.monitoringData.source,p.featureName=this.featureName,p.clientCorrelationid=this.monitoringData.clientCorrelationId,p.qosScenarioName=this.scenarioName,p.qosEventType=t,p.qosTagId=null===e?void 0:e,p.duration=this.duration,p.properties=this.getProperties(n),p)]),r.label=5;case 5:return[2];}});});},e.prototype.getProperties=function(e){var t;return(0,r.pi)((0,r.pi)((0,r.pi)((0,r.pi)({},e),(__WRAPPED_set(t={},s.Z.CLIENT_TIMESTAMP,'=',new Date().getTime().toString()),__WRAPPED_set(t,s.Z.TRANSACTION_ID,'=',this.transactionId),t)),this.monitoringData.properties),this.staticProperties());},e;}());t.Z=u;},451:function(e,t,n){function r(e,t){return e.hasOwnProperty(t);}function i(e){return"object"==typeof e&&!!e&&r(e,"family")&&r(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code;}n.d(t,{x:function(){return i;}});}},o={};e.m=i,e.d=function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:__WRAPPED_get(n,r)});},e.f={},e.e=function(t){return Promise.all(Object.keys(e.f).reduce(function(n,r){return __WRAPPED_call(e.f,r)(t,n),n;},[]));},e.u=function(e){return __WRAPPED_get({14:"vendors_loggingdependencies",239:"loggingdependencies"},e)+"_"+__WRAPPED_get({14:"6a5f2f5299e33b172cec",239:"93278b946fd4334766a5"},e)+".js";},e.g=(function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")();}catch(e){if("object"==typeof window)return window;}}()),e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t);},t={},n="MidgardBootstrapper:",e.l=function(r,i,o,a){if(__WRAPPED_get(t,r))__WRAPPED_get(t,r).push(i);else{var s,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=__WRAPPED_get(l,u);if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==n+o){s=d;break;}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,e.nc&&s.setAttribute("nonce",e.nc),s.setAttribute("data-webpack",n+o),s.src=e.tu(r),0!==s.src.indexOf(__WRAPPED_get(window,'location').origin+"/")&&(s.crossOrigin="anonymous")),__WRAPPED_set(t,r,'=',[i]);var p=function(e,n){s.onerror=s.onload=null,clearTimeout(f);var i=__WRAPPED_get(t,r);if(delete t[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(function(e){return e(n);}),e)return e(n);},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),c&&document.head.appendChild(s);}},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0});},e.tt=function(){return void 0===r&&(r={createScriptURL:function(e){return e;}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(r=trustedTypes.createPolicy("@1js/midgard-bootstrapper#webpack",r))),r;},e.tu=function(t){return e.tt().createScriptURL(t);},e.p="https://res-1.cdn.office.net/midgard/versionless/",(function(){var t={179:0};e.f.j=function(n,r){var i=e.o(t,n)?__WRAPPED_get(t,n):void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise(function(e,r){i=__WRAPPED_set(t,n,'=',[e,r]);});r.push(i[2]=o);var a=e.p+e.u(n),s=new Error();e.l(a,function(r){if(e.o(t,n)&&(0!==(i=__WRAPPED_get(t,n))&&__WRAPPED_set(t,n,'=',void 0),i)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+n+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s);}},"chunk-"+n,n);}};var n=function(n,r){var i,o,a=r[0],s=r[1],c=r[2],l=0;if(a.some(function(e){return 0!==__WRAPPED_get(t,e);})){for(i in s)e.o(s,i)&&__WRAPPED_set(e.m,i,'=',__WRAPPED_get(s,i));c&&c(e);}for(n&&n(r);l<a.length;l++)o=__WRAPPED_get(a,l),e.o(t,o)&&__WRAPPED_get(t,o)&&__WRAPPED_get(t,o)[0](),__WRAPPED_set(t,o,'=',0);},r=self.webpackChunkMidgardBootstrapper=self.webpackChunkMidgardBootstrapper||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r));}());var a={};return(function(){function t(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t);}catch(e){}}function n(e,n,r){return new Promise(function(i,o){e?(t(F,e,r),i(e)):n(function(e,n){e?(t(F,e,r),i(e)):o(new D("GetAuthTokenError","Auth token is undefined",n));},function(e,t,n){var r=(function(e,t){var n=/^AADSTS\d+?:/.test(e),r=(function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0;}return!1;}(e,t));return n||r;}(e,n))?e:"";o(new D("GetAuthTokenError",r,t,n));});});}function r(e,t){var n=(function(e){return"df"===e?x.Dogfood:"msit"===e?x.MSIT:void 0;}(e));return n||(n=(function(e){switch(e){case"Df":return x.Dogfood;case"Msit":return x.MSIT;case"Blackforest":return x.Blackforest;case"GccModerate":return x.GccModerate;case"GccHigh":return x.GccHigh;case"DoD":return x.DOD;case"Gallatin":return x.Gallatin;case"Prod":return x.TopLevel;case"AG08":return x.AG08;case"AG09":return x.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return(0,B.k)(e);}}(t))),n;}function i(e,t){void 0===t&&(t=window);var n="";if(t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(__WRAPPED_get(t,'location').search);n=r&&t.decodeURIComponent(r[1].replace(/\+/g," "))||"";}return n;}function o(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(__WRAPPED_get(t,'location').search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||"";}function s(e,t,n){var i,a,s,c,l,u,d=o("LivePersonaCardCultureOverride",n),p=(a=t.region,s=t.complianceEnvironment,c=d||t.culture,l=null===(i=t.options)||void 0===i?void 0:i.lokiUrlOverride,u=r(a,s),l?R.replace("{0}",l).replace("{1}",c):R.replace("{0}",u).replace("{1}",c));return q(p,e,Q(Q({},t),{clientFeature:"LivePersonaCard"}),n);}function c(e,t,n){var i=(function(e,t){var n=t||e.culture,i=r(e.region,e.complianceEnvironment);return"{0}/api/v1/livepersonaeditor/configuration?cultureName={1}".replace("{0}",i).replace("{1}",n);}(t,o("LivePersonaEditorCultureOverride",n)));return q(i,e,Q(Q({},t),{clientFeature:"LivePersonaEditor"}),n);}function l(e,t,n){var r,i,o;void 0===n&&(n=ce);var a=Object.keys(e).filter(function(e){return!t.includes(e);}),s=(0,K.pi)({},e);try{for(var c=(0,K.XA)(a),u=c.next();!u.done;u=c.next()){var d=u.value,p=__WRAPPED_get(s,d);if("object"!=typeof p||Array.isArray(p))s=Object.assign(s,n(d,__WRAPPED_get(s,d)));else{var f=l(__WRAPPED_get(s,d),t,n);s=Object.assign(s,(__WRAPPED_set(o={},d,'=',f),o));}}}catch(e){r={error:e};}finally{try{u&&!u.done&&(i=c.return)&&i.call(c);}finally{if(r)throw r.error;}}return s;}function u(e,t,n,r){return((function(e){if(!(function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t);}(e)))return!1;var t=se(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t;}(r))?r(e):r)?l(e,t,n):e;}function d(e,t){var n=new URL("https://midgardbranches.blob.core.windows.net/lpc/refs/heads/"),r=t&&"/_next/"!==t?new URL(t):void 0,i=new URL(e,document.baseURI).origin;if(i===n.origin||r&&i===r.origin||(function(e){return ve.includes(e);}(i))||fe.test(i))return e;throw new Error("TrustedType policy does not allow loading scripts from ".concat(i,", only from ").concat(n.origin,", ").concat(null==r?void 0:r.origin," and localhost."));}function p(){if(void 0===_&&(_=null,"undefined"!=typeof self&&self.trustedTypes))try{_=self.trustedTypes.createPolicy("@1js/midgard-trusted-types",{createHTML:function(e){return e;},createScript:function(e){return e;},createScriptURL:function(e,t){return void 0===t&&(t=he),d(e,t);}});}catch(e){}return _;}function f(e,t,n,r,i){var o=this;void 0===r&&(r=!1),void 0===i&&(i=!1);var a=0,s=function(e,t){return c=o,l=void 0,d=function(){var o;return(function(e,t){function n(n){return function(a){return(function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue;}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break;}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break;}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break;}o[2]&&s.ops.pop(),s.trys.pop();continue;}n=t.call(e,s);}catch(e){n=[6,e],i=0;}finally{r=o=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}([n,a]));};}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1];},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(a,Symbol.iterator,'=',function(){return this;}),a;}(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,6]),[4,h(e,t,r,i,n)];case 1:return c.sent(),[3,6];case 2:return o=c.sent(),a<2?(a++,[4,s(e,t)]):[3,4];case 3:return c.sent(),[3,5];case 4:throw o.numberOfRetries=a,o;case 5:return[3,6];case 6:return[2];}}));},new((u=void 0)||(u=Promise))(function(e,t){function n(e){try{i(d.next(e));}catch(e){t(e);}}function r(e){try{i(d.throw(e));}catch(e){t(e);}}function i(t){var i;t.done?e(t.value):((i=t.value)instanceof u?i:new u(function(e){e(i);})).then(n,r);}i((d=d.apply(c,l||[])).next());});var c,l,u,d;};return s(e,t);}function h(t,n,r,i,o){return new Promise(function(a,s){n||s(new D("StartLivePersonaCardError","targetWindow is undefined in appendScriptToDocumentAsync"));var c=n.document.querySelectorAll("script[".concat(ge,"]"));if(i&&2===c.length)a();else{var l=(function(e,t,n){void 0===t&&(t=he),void 0===n&&(n=!0);var r,i=null,o=p();try{i=n&&o?o.createScriptURL(e,t):d(e,t);}catch(e){r=e.message;}return{error:r,url:i,trustedTypeAvailable:!!o};}(t,e.p,r));if(l.error)return s(new D("LoadScriptError",l.error));var u=n.document.createElement("script");u.type="text/javascript",u.charset="utf-8",u.setAttribute(ge,""),u.crossOrigin="anonymous",u.src=l.url,u.addEventListener("load",function(){o&&o({name:"LoadScriptSuccess",properties:{isLPCDefined:!!n.LPC,lpcWindowId:n.lpcWindowId}}),a();}),u.addEventListener("error",function(){o&&o({name:"LoadScriptFailure",properties:{isLPCDefined:!!n.LPC,lpcWindowId:n.lpcWindowId}}),s(new D("LoadScriptError","Unexpected error while loading script on page, lpcWindowId:"+n.lpcWindowId));}),n.document.body.appendChild(u);}});}function v(e){var t=e.targetWindow||window,n=ye.get(t);return n?n.bootstrapperConfig=me(me({},n.bootstrapperConfig),e):(n={bootstrapperConfig:me(me({},e),{targetWindow:t}),ariaLogger:new pe(e),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0}).bootstrapperConfig.targetWindow.lpcWindowId=(0,N.pW)(),ye.set(t,n),n;}function g(e,t,n){return be(this,void 0,void 0,function(){var r,i;return Ce(this,function(o){switch(o.label){case 0:return(i=v(t)).lpcConfig?(r=i.lpcConfig,[3,3]):[3,1];case 1:return[4,m(e,t,n)];case 2:r=o.sent(),i.lpcConfig=r,o.label=3;case 3:return[2,r];}});});}function m(e,t,r){return be(this,void 0,void 0,function(){var i,o;return Ce(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,8]),[4,s(e,t,r)];case 1:return i=a.sent(),[3,8];case 2:return(o=a.sent()).statusCode&&401===o.statusCode?[4,n(void 0,t.getAuthToken,r)]:[3,4];case 3:e=a.sent(),a.label=4;case 4:return Se<2?(Se++,[4,m(e,t,r)]):[3,6];case 5:return i=a.sent(),[3,7];case 6:throw o.numberOfRetries=Se,o;case 7:return[3,8];case 8:return[2,i];}});});}function y(e,t,n,r,i){var o=e.ResourceUrls||[];if(0===o.length){var a=e.Resources?e.Resources.livepersonacardstrings:"",s=e.Resources?null==e?void 0:e.Resources["livepersonacard_with-react"]:"";"OwaPeopleHub"===e.Workload&&(s=e.Resources?e.Resources["livepersonacard_without-react"]:""),o=[a,s].filter(function(e){return""!==e;});}return Promise.all(o.map(function(e){return f(e,t,n,r,i);})).then(function(){return o;});}function b(e,t){var n=this,r=t.targetWindow;return new Promise(function(i,o){setTimeout(function(){return a=n,s=void 0,l=function(){var n,a;return(function(e,t){function n(n){return function(a){return(function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue;}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break;}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break;}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break;}o[2]&&s.ops.pop(),s.trys.pop();continue;}n=t.call(e,s);}catch(e){n=[6,e],i=0;}finally{r=o=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}([n,a]));};}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1];},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(a,Symbol.iterator,'=',function(){return this;}),a;}(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),r||o(new D("StartLivePersonaCardError","targetWindow is undefined in startLivePersonaCardAsync")),r.LPC||o(new D("StartLivePersonaCardError","targetWindow.LPC is undefined., lpcWindowId:"+r.lpcWindowId)),r.LivePersonaCardStrings&&r.LivePersonaCardStrings.strings||r.LivePersonaCardStringsLpcMini&&r.LivePersonaCardStringsLpcMini.strings||o(new D("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined, lpcWindowId:"+r.lpcWindowId)),n=(function(e,t){var n,r,i,o,a=t.targetWindow;return{accountId:t.accountId,refreshAuthToken:(o=t.getAuthToken,function(e){o(function(t,n){e(t,"",n,void 0);},function(t,n){e("",t,n,void 0);});}),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:a.LivePersonaCardStringsLpcMini&&a.LivePersonaCardStringsLpcMini.strings||a.LivePersonaCardStrings&&a.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId&&(0,N.SD)(t.clientCorrelationId)?t.clientCorrelationId:"00000000-0000-0000-0000-000000000000",activeFlights:e.Flights?Pe([],e.Flights,!0):[],isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,setConfigurationManagerForTesting:t.setConfigurationManagerForTesting,lokiUrl:(null===(n=t.options)||void 0===n?void 0:n.lokiUrlOverride)||e.LokiUrl||"",lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId||"",userAadObjectId:e.UserAadObjectId||"",userPuid:e.UserPuid||"",ecsConfigIds:e.EcsConfigIds?Pe([],e.EcsConfigIds,!0):[],ecsETag:e.EcsEtag||"",loggedInUserUpn:e.Upn||"",loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName||"",app:t.app,platform:t.platform,telemetryCollectorUrlAria:(null===(r=e.ClientTelemetryCollectorUrls)||void 0===r?void 0:r.Aria)||t.telemetryCollectorUrlAria,telemetryCollectorUrlOneDs:(null===(i=e.ClientTelemetryCollectorUrls)||void 0===i?void 0:i.OneDs)||t.telemetryCollectorUrlOneDs,versionOverride:t.versionOverride};}(e,t)),[4,r.LPC.start(n)];case 1:return s.sent(),i(),[3,3];case 2:return a=s.sent(),o(new D("StartLivePersonaCardError",a.name)),[3,3];case 3:return[2];}}));},new((c=void 0)||(c=Promise))(function(e,t){function n(e){try{i(l.next(e));}catch(e){t(e);}}function r(e){try{i(l.throw(e));}catch(e){t(e);}}function i(t){var i;t.done?e(t.value):((i=t.value)instanceof c?i:new c(function(e){e(i);})).then(n,r);}i((l=l.apply(a,s||[])).next());});var a,s,c,l;},0);});}function C(e){switch(e.complianceEnvironment){case"Blackforest":return"e5ad760145754ffc9704e67c800087f2-accc9196-f40d-49fd-8968-2e6240e5d84c-7381";case"GccHigh":return"e5ad760145754ffc9704e67c800087f2-3831d322-8b62-464b-8147-272e41908150-7184";case"DoD":return"e5ad760145754ffc9704e67c800087f2-27405810-62d9-4796-a308-28b057a92523-6970";case"Gallatin":return"e5ad760145754ffc9704e67c800087f2-97d9a12c-35b6-4ec7-9bb9-d00d7b5d28d2-7079";case"AG08":case"AG09":return"";default:return"e5ad760145754ffc9704e67c800087f2-994e0432-dd0e-4a24-9a3d-bb9d8a6b83f3-7303";}}function S(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""};}function P(e){return void 0===e||"string"!=typeof e||""===e||null===e;}function w(e){return void 0===e||"function"!=typeof e;}function T(e){var t="";if(e){var n=[];P(e.culture)&&n.push("culture"),P(e.clientType)&&n.push("clientType"),P(e.clientContextType)&&n.push("clientContextType"),P(e.clientCorrelationId)&&n.push("clientCorrelationId"),w(e.logMessage)&&n.push("logMessage"),w(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): ".concat(n.join(", "),". Check the values and types you're passing. ")),e.region&&-1===ke.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, "+"and ".concat(ke.join(", ")," for pre-production environments. ")),-1===Te.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: ".concat(Te.join(", "),". We currently don't support other Sovereign Clouds."));}else t="Config must be defined.";if(t)throw new D("ValidateBootstrapperConfigError",t);}function k(e,t,n){return Ae(this,void 0,void 0,function(){var r,i;return Ie(this,function(o){switch(o.label){case 0:return(i=v(t)).lpeConfig?(r=i.lpeConfig,[3,3]):[3,1];case 1:return[4,A(e,t,n)];case 2:r=o.sent(),i.lpeConfig=r,o.label=3;case 3:return[2,r];}});});}function A(e,t,r){return Ae(this,void 0,void 0,function(){var i,o;return Ie(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,8]),[4,c(e,t,r)];case 1:return i=a.sent(),[3,8];case 2:return(o=a.sent()).statusCode&&401===o.statusCode?[4,n(void 0,t.getAuthToken,r)]:[3,4];case 3:e=a.sent(),a.label=4;case 4:return Le<2?(Le++,[4,k(e,t,r)]):[3,6];case 5:return i=a.sent(),[3,7];case 6:throw o.numberOfRetries=Le,o;case 7:return[3,8];case 8:return[2,i];}});});}function I(e,t){var n,r,i,o=e.Flights?(function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),__WRAPPED_set(r,i,'=',__WRAPPED_get(t,i)));return e.concat(r||Array.prototype.slice.call(t));}([],e.Flights,!0)):[],a=(null===(n=e.Resources)||void 0===n?void 0:n.livepersonaeditorstrings)||"",s=(null===(r=e.Resources)||void 0===r?void 0:r["livepersonaeditor_with-react"])||"",c=(null===(i=e.Resources)||void 0===i?void 0:i["livepersonaeditor_without-react"])||"",l=[a,o.indexOf("withreact")>-1?s:c].filter(function(e){return""!==e;});return Promise.all(l.map(function(e){return f(e,t);})).then(function(){return l;});}function L(e){return Ee(this,void 0,void 0,function(){var t,r,i,o=this;return Ue(this,function(a){return t=new we(window),r=v(e),i=function(){return v(e).ariaLogger;},!r.forceRefreshLpeInitializationPromise&&r.lpeInitializationPromise||(r.lpeInitializationPromise=new Promise(function(r,a){return Ee(o,void 0,void 0,function(){var o,s,c,l,u;return Ue(this,function(d){switch(d.label){case 0:o=C(e),d.label=1;case 1:return d.trys.push([1,6,,7]),T(e),t.startCustomTiming("Perf_GetAuthTokenDuration"),[4,n(e.authToken,e.getAuthToken,window)];case 2:return s=d.sent(),t.endCustomTiming("Perf_GetAuthTokenDuration"),t.measureFromStart("Perf_GetAuthTokenFromStartDuration"),t.startCustomTiming("Perf_GetLokiConfigDuration"),[4,k(s,e,window)];case 3:return c=d.sent(),t.endCustomTiming("Perf_GetLokiConfigDuration"),t.measureFromStart("Perf_GetLokiConfigFromStartDuration"),t.startCustomTiming("Perf_GetLpeBundlesDuration"),[4,I(c,window)];case 4:return d.sent(),t.endCustomTiming("Perf_GetLpeBundlesDuration"),t.measureFromStart("Perf_GetLpeBundlesFromStartDuration"),[4,i().updateContextWithLokiDataAsync(c,o).catch(function(){console.log("Live Persona Editor ERROR: Bootstrapper failed to initialize Aria, continuing without.");})];case 5:return d.sent(),i().logEventAsync({name:"initializeLivePersonaEditor_success",properties:Oe(Oe({},t.getAllTimings()),{RootCorrelationId:c.RootCorrelationId,isConsumer:"".concat(e.isConsumer)})},o),r(c),[3,7];case 6:return l=d.sent(),u=t.getAllTimings(),i().logEventAsync({name:"initializeLivePersonaEditor_failure",properties:Oe(Oe(Oe({},S(l)),u),{isConsumer:"".concat(e.isConsumer)})},o),a("Failed to initialize Live Persona Editor: ".concat(l.name," ").concat(l.message)),[3,7];case 7:return[2];}});});}),r.lpeInitializationPromise.catch(function(){setTimeout(function(){r.forceRefreshLpeInitializationPromise=!0;},M);})),[2,r.lpeInitializationPromise];});});}function O(e){return Me(this,void 0,void 0,function(){var t,r,i,o,a=this;return De(this,function(s){return!(t=v(e)).forceRefreshInitializationPromise&&t.initializationPromise||(r=function(){return t.ariaLogger;},i=t.bootstrapperConfig.targetWindow,o=new we(i),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(s,c){return Me(a,void 0,void 0,function(){var a,l,u,d,p,f,h;return De(this,function(v){switch(v.label){case 0:a=C(e),v.label=1;case 1:return v.trys.push([1,7,,8]),T(e),o.startCustomTiming("Perf_GetAuthTokenDuration"),[4,n(e.authToken,e.getAuthToken,i)];case 2:return l=v.sent(),o.endCustomTiming("Perf_GetAuthTokenDuration"),o.measureFromStart("Perf_GetAuthTokenFromStartDuration"),o.startCustomTiming("Perf_GetLokiConfigDuration"),[4,g(l,e,i)];case 3:return u=v.sent(),o.endCustomTiming("Perf_GetLokiConfigDuration"),o.measureFromStart("Perf_GetLokiConfigFromStartDuration"),o.startCustomTiming("Perf_GetLpcBundlesDuration"),[4,r().updateContextWithLokiDataAsync(u,a).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.");})];case 4:return v.sent(),[4,y(u,i,function(e){r().logVerboseEventAsync(e,a);},null===(f=e.options)||void 0===f?void 0:f.isTrustedTypesEnabled,null===(h=e.options)||void 0===h?void 0:h.isReuseScriptsEnabled)];case 5:return v.sent(),o.endCustomTiming("Perf_GetLpcBundlesDuration"),o.measureFromStart("Perf_GetLpcBundlesFromStartDuration"),o.startCustomTiming("Perf_StartLpcDuration"),[4,b(u,t.bootstrapperConfig)];case 6:return v.sent(),o.endCustomTiming("Perf_StartLpcDuration"),o.measureFromStart("Perf_StartLpcFromStartDuration"),r().logEventAsync({name:"initializeLivePersonaCard_success",properties:xe(xe({},o.getAllTimings()),{RootCorrelationId:u.RootCorrelationId,isConsumer:"".concat(e.isConsumer),lpcWindowId:i.lpcWindowId})},a),s(),[3,8];case 7:return d=v.sent(),p=o.getAllTimings(),r().logEventAsync({name:"initializeLivePersonaCard_failure",properties:xe(xe(xe({},S(d)),p),{isConsumer:"".concat(e.isConsumer),lpcWindowId:i.lpcWindowId})},a),c("Failed to initialize Live Persona Card: ".concat(d.name," ").concat(d.message)),[3,8];case 8:return[2];}});});}),t.initializationPromise.catch(function(){t.forceRefreshInitializationTimeout=window.setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0);},M);})),[2,t.initializationPromise];});});}function E(e){!(function(e){var t,n=ye.get(e);if(n){var r=n.bootstrapperConfig.targetWindow,i=null===(t=n.bootstrapperConfig.options)||void 0===t?void 0:t.isReuseScriptsEnabled;if(r&&(r.LPC&&r.LPC.cleanUp&&r.LPC.cleanUp(),!i)){delete r.LPC,delete r.LivePersonaCardHoverTarget,delete r.LivePersonaCardHoverTargetV2,delete r.LivePersonaCardStrings,delete r.LivePersonaCardStringsLpcMini,delete r.MeetingInsightsV2,delete r.MidgardBootstrapper,delete r.PersonaInsightRing,delete r.LPE,delete r.lpcWindowId;try{r.document.querySelectorAll("script[".concat(ge,"]")).forEach(function(e){return e.remove();});}catch(e){console.warn("midgard-bootstrapper:deleteBootstrapperInstance(): Failed removing one or more script tags");}}delete n.bootstrapperConfig.targetWindow,delete n.ariaLogger,delete n.bootstrapperConfig,n.initializationPromise=void 0,clearTimeout(n.forceRefreshInitializationTimeout);}ye.delete(e);}(e));}function U(e){return Me(this,void 0,void 0,function(){var t;return De(this,function(r){switch(r.label){case 0:return t=v(e),[4,n(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,g(r.sent(),e,t.bootstrapperConfig.targetWindow)];}});});}e.r(a),e.d(a,{fetchLokiConfigAsync:function(){return U;},freeBootstrapperMemory:function(){return E;},initializeLivePersonaCardAsync:function(){return O;},initializeLivePersonaEditorAsync:function(){return L;}});var x,M=3e5,D=function(e,t,n,r,i,o){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=i,this.numberOfRetries=o;},F="LokiAuthToken",B=e(932);!(function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud";}(x||(x={})));var _,R="{0}/api/v1/livepersonacard/configuration?cultureName={1}",N=e(928),G="LivePersonaEditorBranchOverride",H="LivePersonaCardVersionOverride",j="MidgardVersion",V="MidgardBranch",X="HostAppConfiguration",z="LivePersonaEditorVersionOverride",W=function(e,t,n,r,i,o){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=i,this.numberOfRetries=o;},q=function(e,t,n,r,o,a,s){return void 0===o&&(o={}),void 0===a&&(a=6e4),new Promise(function(c,l){var u,d=new XMLHttpRequest(),p=(function(e,t){var n=i("ClientTypeOverride",t)||e.clientType,r=i("MidgardOnlyOverrideCatalog",t),o=i(X,t),a=i(j,t);return{clientTypeOverride:n,hostAppConfigurationQSP:o,versionOverride:(r?"":a)||i(H,t)||e.versionOverride||"",lpeVersionOverride:(r?"":a)||i(z,t),lpeBranchOverride:i(G,t),midgardBranchOverride:r?"":i(V,t)};}(n,r)),f=p.clientTypeOverride,h=p.hostAppConfigurationQSP,v=p.versionOverride,g=p.lpeVersionOverride,m=p.lpeBranchOverride,y=p.midgardBranchOverride;d.open("GET",e,!0),d.setRequestHeader("Authorization","Bearer "+t),d.setRequestHeader("Accept","application/json");var b=null!==(u=o.requestId)&&void 0!==u?u:(0,N.pW)();if(d.setRequestHeader("X-RootCorrelationId",b),d.setRequestHeader("X-CorrelationId",b),d.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),d.setRequestHeader("X-ClientFeature",n.clientFeature),d.setRequestHeader("X-ClientArchitectureVersion","v2"),d.setRequestHeader("X-ClientScenario","GetConfiguration"),s&&d.setRequestHeader("X-LPCVersion",s),f&&d.setRequestHeader("X-ClientType",f),n.app&&d.setRequestHeader("X-HostAppApp",n.app),n.platform&&d.setRequestHeader("X-HostAppPlatform",n.platform),n.hostAppRing&&d.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&d.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&d.setRequestHeader("X-HostAppConfiguration",JSON.stringify(n.hostAppConfiguration)),h){var C={};h.split(";").forEach(function(e){var t=e.split(":"),n=t[0],r=t[1];__WRAPPED_set(C,n,'=',r);}),d.setRequestHeader(X,JSON.stringify(C));}r&&r.React&&r.React.version&&r.ReactDOM&&d.setRequestHeader("X-HostAppReactVersion",r.React.version),v&&(d.setRequestHeader(H,v),d.setRequestHeader(j,v)),g&&d.setRequestHeader("X-".concat(z),g),m&&d.setRequestHeader("X-".concat(G),m),y&&(d.setRequestHeader(V,y),d.setRequestHeader("X-".concat(V),y)),d.addEventListener("load",function(){if(200===d.status)try{var e=JSON.parse(d.response);e.RootCorrelationId=b,e.LokiVersion=d.getResponseHeader("x-serverversion")||"",c(e);}catch(e){l(new W("GetLokiConfigError","Failed to parse initialization config.",b));}else l(new W("GetLokiConfigError","Couldn't retrieve initialization config. Status code is ".concat(d.status),b,!1,d.status));}),d.addEventListener("error",function(){l(new W("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",b));}),d.addEventListener("timeout",function(){l(new W("GetLokiConfigError","Loki config request timed out after ".concat(a," ms."),b));}),d.timeout=a,d.send();});},Q=function(){return(Q=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=__WRAPPED_get(arguments,n))Object.prototype.hasOwnProperty.call(t,i)&&__WRAPPED_set(e,i,'=',__WRAPPED_get(t,i));return e;}).apply(this,arguments);},K=e(682),Z=(e(895),function(){return Promise.all([e.e(14),e.e(239)]).then(e.bind(e,809));}),J=function(){return Z().then(function(e){return e.AWTLogManager;});},$="object"==typeof e.g&&e.g&&e.g.Object===Object&&e.g,Y="object"==typeof self&&self&&self.Object===Object&&self,ee=($||Y||Function("return this")()).Symbol,te=Object.prototype,ne=te.hasOwnProperty,re=te.toString,ie=ee?ee.toStringTag:void 0,oe=Object.prototype.toString,ae=ee?ee.toStringTag:void 0,se=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ae&&ae in Object(e)?(function(e){var t=ne.call(e,ie),n=__WRAPPED_get(e,ie);try{__WRAPPED_set(e,ie,'=',void 0);var r=!0;}catch(e){}var i=re.call(e);return r&&(t?__WRAPPED_set(e,ie,'=',n):delete e[ie]),i;}(e)):(function(e){return oe.call(e);}(e));},ce=function(e){var t;return __WRAPPED_set(t={},e,'=',"SCRUBBED"),t;},le=["Perf_GetAuthTokenDuration","Perf_GetAuthTokenFromStartDuration","Perf_GetLokiConfigDuration","Perf_GetLokiConfigFromStartDuration","Perf_GetLpcBundlesDuration","Perf_GetLpcBundlesFromStartDuration","Perf_StartLpcDuration","Perf_StartLpcFromStartDuration","Perf_GetLpeBundlesDuration","Perf_GetLpeBundlesFromStartDuration","Perf_AuthRequestDuration","Perf_LpcBundleRequestDuration","Perf_LpcStringsRequestDuration","Perf_InitConfigRequestDuration","isConsumer","ErrorType","ErrorMessage","IsExpected","IsClientOnline","name"],ue=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t);})).then(a,s);}c((r=r.apply(e,t||[])).next());});},de=function(e,t){function n(n){return function(a){return(function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue;}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break;}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break;}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break;}o[2]&&s.ops.pop(),s.trys.pop();continue;}n=t.call(e,s);}catch(e){n=[6,e],i=0;}finally{r=o=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}([n,a]));};}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1];},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(a,Symbol.iterator,'=',function(){return this;}),a;},pe=(function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map(),e.telemetryCollectorUrlAria&&this.setCollectorUri(e.telemetryCollectorUrlAria);}return e.prototype.logEventAsync=function(e,t){return ue(this,void 0,void 0,function(){var n,r,i=this;return de(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n=o.sent(),r=u(e,le,function(e){var t;return __WRAPPED_set(t={},e,'=',"SCRUBBED"),t;},function(){return!i.collectorUri;}),n.logEvent(r),[4,J()];case 2:return o.sent().flush(this.noOp),[3,4];case 3:return o.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2];}});});},e.prototype.logVerboseEventAsync=function(e,t){return ue(this,void 0,void 0,function(){return de(this,function(n){switch(n.label){case 0:return this.bootstrapperConfig.enableVerboseLogging?[4,this.logEventAsync(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2];}});});},e.prototype.updateContextWithLokiDataAsync=function(e,t){var n;return ue(this,void 0,void 0,function(){var r,i;return de(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getLoggerAsync(t,e)];case 1:return r=o.sent(),(i=this.getCollectorUri(e))&&(this.setCollectorUri(i),e.TenantAadObjectId&&r.setContext("tenantAadObjectId",e.TenantAadObjectId),e.UserAadObjectId&&r.setContext("userAadObjectId",e.UserAadObjectId),e.UserPuid&&r.setContext("userPuid",e.UserPuid)),e.LokiUrl&&r.setContext("LokiUrl",e.LokiUrl),e.Flights&&r.setContext("flights",null===(n=null==e?void 0:e.Flights)||void 0===n?void 0:n.join(",")),r.setContext("settings",JSON.stringify(e.Settings)),[3,3];case 2:throw o.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2];}});});},e.prototype.getLoggerAsync=function(e,t){return ue(this,void 0,void 0,function(){var n,r,i;return de(this,function(o){switch(o.label){case 0:return(n=this.loggers.get(e))?[3,2]:[4,J()];case 1:r=o.sent(),(i=this.getCollectorUri(t))&&this.setCollectorUri(i),(n=r.initialize(e,{collectorUri:this.collectorUri,disableCookiesUsage:!0}))||(n=r.getLogger(e)),this.loggers.set(e,n),n.setContext("culture",this.bootstrapperConfig.culture),n.setContext("region",this.bootstrapperConfig.region),n.setContext("clientType",this.bootstrapperConfig.clientType),this.bootstrapperConfig.app&&n.setContext("app",this.bootstrapperConfig.app),this.bootstrapperConfig.platform&&n.setContext("platform",this.bootstrapperConfig.platform),n.setContext("clientContextType",this.bootstrapperConfig.clientContextType),i&&n.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),n.setContext("bootstrapperVersion","1.20221130.9.0"),n.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),n.setContext("isConsumer",this.bootstrapperConfig.isConsumer),n.setContext("versionOverride",this.bootstrapperConfig.versionOverride||""),n.setContext("hostAppRing",this.bootstrapperConfig.hostAppRing||""),n.setContext("hostAppVersion",this.bootstrapperConfig.hostAppVersion||""),o.label=2;case 2:return[2,n];}});});},e.prototype.setCollectorUri=function(e){this.collectorUri=e;},e.prototype.getCollectorUri=function(e){var t,n=(null===(t=null==e?void 0:e.ClientTelemetryCollectorUrls)||void 0===t?void 0:t.Aria)||this.bootstrapperConfig.telemetryCollectorUrlAria;if(n)return n;switch(this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return"https://de.pipe.aria.microsoft.com/Collector/3.0/";case"GccHigh":return"https://tb.pipe.aria.microsoft.com/Collector/3.0";case"DoD":return"https://pf.pipe.aria.microsoft.com/Collector/3.0";case"AG08":case"AG09":return"";default:return;}},e.prototype.noOp=function(){},e;}()),fe=new RegExp("https?://localhost(:|/|$)"),he=e.p,ve=["https://res.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud"],ge="data-is-midgard-bootstrapper-script",me=function(){return(me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=__WRAPPED_get(arguments,n))Object.prototype.hasOwnProperty.call(t,i)&&__WRAPPED_set(e,i,'=',__WRAPPED_get(t,i));return e;}).apply(this,arguments);},ye=new WeakMap(),be=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t);})).then(a,s);}c((r=r.apply(e,t||[])).next());});},Ce=function(e,t){function n(n){return function(a){return(function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue;}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break;}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break;}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break;}o[2]&&s.ops.pop(),s.trys.pop();continue;}n=t.call(e,s);}catch(e){n=[6,e],i=0;}finally{r=o=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}([n,a]));};}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1];},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(a,Symbol.iterator,'=',function(){return this;}),a;},Se=0,Pe=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),__WRAPPED_set(r,i,'=',__WRAPPED_get(t,i)));return e.concat(r||Array.prototype.slice.call(t));},we=(function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={};}return e.prototype.measureFromStart=function(e){__WRAPPED_set(this.timings,e,'=',Math.round(this.getCurrentTime()-this.start));},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-start"));}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-end")),this.targetWindow.performance.measure(e,"".concat(e,"-start"),"".concat(e,"-end"));var t=this.targetWindow.performance.getEntriesByName(e)[0];__WRAPPED_set(this.timings,e,'=',Math.round(t.duration));}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=Math.round(t.duration);-1!==n.indexOf("authtoken/loki")||-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?e.timings.Perf_AuthRequestDuration=r:-1!==n.indexOf("/lpc/versionless/livepersonacard_")?e.timings.Perf_LpcBundleRequestDuration=r:-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?e.timings.Perf_LpcStringsRequestDuration=r:-1!==n.indexOf("/api/v1/configuration/")&&(e.timings.Perf_InitConfigRequestDuration=r);}});}catch(e){}return this.timings;},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now();},e;}()),Te=["Df","Msit","Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09","Unknown"],ke=["msit","df"],Ae=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t);})).then(a,s);}c((r=r.apply(e,t||[])).next());});},Ie=function(e,t){function n(n){return function(a){return(function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue;}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break;}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break;}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break;}o[2]&&s.ops.pop(),s.trys.pop();continue;}n=t.call(e,s);}catch(e){n=[6,e],i=0;}finally{r=o=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}([n,a]));};}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1];},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(a,Symbol.iterator,'=',function(){return this;}),a;},Le=0,Oe=function(){return(Oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=__WRAPPED_get(arguments,n))Object.prototype.hasOwnProperty.call(t,i)&&__WRAPPED_set(e,i,'=',__WRAPPED_get(t,i));return e;}).apply(this,arguments);},Ee=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t);})).then(a,s);}c((r=r.apply(e,t||[])).next());});},Ue=function(e,t){function n(n){return function(a){return(function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue;}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break;}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break;}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break;}o[2]&&s.ops.pop(),s.trys.pop();continue;}n=t.call(e,s);}catch(e){n=[6,e],i=0;}finally{r=o=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}([n,a]));};}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1];},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(a,Symbol.iterator,'=',function(){return this;}),a;},xe=function(){return(xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=__WRAPPED_get(arguments,n))Object.prototype.hasOwnProperty.call(t,i)&&__WRAPPED_set(e,i,'=',__WRAPPED_get(t,i));return e;}).apply(this,arguments);},Me=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t);})).then(a,s);}c((r=r.apply(e,t||[])).next());});},De=function(e,t){function n(n){return function(a){return(function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue;}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break;}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break;}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break;}o[2]&&s.ops.pop(),s.trys.pop();continue;}n=t.call(e,s);}catch(e){n=[6,e],i=0;}finally{r=o=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}([n,a]));};}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1];},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(a,Symbol.iterator,'=',function(){return this;}),a;};try{var Fe=window.document.createElement("link"),Be=Boolean("onmscontentzoom"in window.document);Fe.rel=Be?"dns-prefetch":"preconnect",Fe.href="https://res-1.cdn.office.net/",window.document.head.appendChild(Fe);}catch(M){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",M);}}()),a;}());}));},2407:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=__WRAPPED_get(arguments,n);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&__WRAPPED_set(e,i,'=',__WRAPPED_get(t,i));}return e;}).apply(this,arguments);},i=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e);});}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){e.done?n(e.value):i(e.value).then(a,s);}c((r=r.apply(e,t||[])).next());});},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t]);};}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue;}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break;}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break;}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break;}a[2]&&c.ops.pop(),c.trys.pop();continue;}n=t.call(e,c);}catch(e){n=[6,e],o=0;}finally{i=a=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1];},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(s,Symbol.iterator,'=',function(){return this;}),s;};Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),s=n(129),c=n(285),l=n(142),u=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i);};},d=function(e,t){return function(n,r){return void 0===r&&(r=!1),i(void 0,void 0,void 0,function(){var i,a,s;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.getChatConversationWith(n)];case 1:if(!(i=o.sent()))throw"Invalid chat conversation.";return[3,3];case 2:return a=o.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(a),[2,Promise.reject("_placeCall(): Failed to find chat conversation with error "+s)];case 3:return[2,t.placeCall({conversationId:i.id,withVideo:r,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})];}});});};},p=function(e,t){return function(n,r){return i(void 0,void 0,void 0,function(){var i,a,s,c;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.getChatConversationWith(n)];case 1:if(!(i=o.sent()))throw"Invalid chat conversation";return[3,3];case 2:return a=o.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(a),[2,Promise.reject("_sendMessage(): Cannot find the chat with error "+s)];case 3:return c=SkypeX.Services.Utilities.newClientMessageId(),[2,t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:c,externalId:null,draftObjectId:null,inlineImages:null})];}});});};},f=function(e,t,n,c,l,u,d){return function(p,f){var h=p.persona;return i(void 0,void 0,void 0,function(){var i,p,v,g,m,y,b,C,S,P;return o(this,function(o){switch(o.label){case 0:t.info("LPC::Starting chat"),o.label=1;case 1:return o.trys.push([1,5,,6]),i=n.getFreshnessInMs(),p=e.scenarios.people.lpcStartChat,v=h.TeamsMri,g=h.Upn,[4,n.getAllPeopleProfile([v||g],p,!Boolean(v),!1,i)];case 2:return m=o.sent()[0],y=l.isCurrentUserTFLOrMsaAccount(),(b=s.getIsMixedChatUser(y,m.type))&&m.type===e.userTypes.tflConsumer&&(m=r(r({},m),{mri:v.replace("8:","8:tfl:")})),[4,c.getConversationWithV2(m.mri,p)];case 3:return C=o.sent(),[4,u({groupName:m.displayName,peopleSlug:C.id,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 4:return o.sent(),f(!0),d(a.LpcCallbackTelemetryType.lpcStartChat,m.mri),[3,6];case 5:return S=o.sent(),P="Failed to navigate to chat",t.error(P),f(!1,P),[3,6];case 6:return[2];}});});};},h=function(e,t,n,r,s,c){return function(l,u){return i(void 0,void 0,void 0,function(){var i,d,p,f,h,v,g;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),t.info("LPC::Navigating to user's org chart"),i=n.getFreshnessInMs(),d=e.scenarios.people.lpcOrgChart,p=l.TeamsMri,f=l.Upn,[4,n.getAllPeopleProfile([p||f],d,!Boolean(p),!1,i)];case 1:return h=o.sent()[0],(p=h.mri)!==c.getCurrentSkypeMri()?[3,3]:[4,r({slug:SkypeX.Services.ChatServiceUtils.SelfChatConversationId,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return o.sent(),[3,5];case 3:return[4,r({groupName:h.displayName,slug:p,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 4:o.sent(),o.label=5;case 5:return u(!0),s(a.LpcCallbackTelemetryType.lpcOrgChart,p),[3,7];case 6:return v=o.sent(),g="Failed to navigate to org chat",t.error(g),u(!1,g),[3,7];case 7:return[2];}});});};},v=function(e,t,n,r,s,c){return function(u,d){return i(void 0,void 0,void 0,function(){var i,p,f,h,v,g;return o(this,function(o){switch(o.label){case 0:return i=e.scenarios.people.lpcLinkedIn,[4,l.resolveMriIfNeeded(u,n,i)];case 1:p=o.sent(),o.label=2;case 2:return o.trys.push([2,6,,7]),t.info("LPC::Navigating to user's LinkedIn"),[4,n.getPeopleProfile(p,i,!1)];case 3:return f=o.sent(),[4,r.getChatConversationWith(p)];case 4:return h=o.sent(),[4,s({groupName:f.displayName,slug:h.id,middlePane:e.peopleTab.panes.linkedin,ctx:e.navigation.context.chat})];case 5:return o.sent(),d&&d(!0),c(a.LpcCallbackTelemetryType.lpcLinkedIn,p),[3,7];case 6:return v=o.sent(),g="Failed to navigate to LinkedIn.",t.error(g),d&&d(!1,g),[3,7];case 7:return[2];}});});};},g=function(e,t,n,r,s){return function(c,u){return i(void 0,void 0,void 0,function(){var i,d,p,f;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t.info("LPC::Starting audio call"),i=e.scenarios.people.lpcGetPersonaInfo,[4,l.resolveMriIfNeeded(c,n,i)];case 1:return d=o.sent(),[4,r(d)];case 2:return o.sent(),u(!0),s(a.LpcCallbackTelemetryType.lpcAudioCall,d),[3,4];case 3:return p=o.sent(),f="Failed to start audio call with",t.error(f),u(!1,f),[3,4];case 4:return[2];}});});};},m=function(e,t,n,r,s){return function(c,u){return i(void 0,void 0,void 0,function(){var i,d,p,f;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t.info("LPC::Starting video call"),i=e.scenarios.people.lpcGetPersonaInfo,[4,l.resolveMriIfNeeded(c,n,i)];case 1:return d=o.sent(),[4,r(d,!0)];case 2:return o.sent(),u(!0),s(a.LpcCallbackTelemetryType.lpcVideoCall,d),[3,4];case 3:return p=o.sent(),f="Failed to start video call with",t.error(f),u(!1,f),[3,4];case 4:return[2];}});});};};t.makeSendQuickMessage=function(e,t,n,r,s){return function(c,l,u){return i(void 0,void 0,void 0,function(){var i,d,p,f,h,v;return o(this,function(o){switch(o.label){case 0:if(i=c.TeamsMri)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),d=e.scenarios.people.lpcSendQuickMessage,[4,n.getAllShortPeopleProfile([c.Upn],d,!0,void 0,!0,void 0,!0)];case 2:return p=o.sent()[0],i=null===p||void 0===p?void 0:p.mri,[3,4];case 3:return f=o.sent(),v="Could not resolve user",t.error(v),u(!1,v),[2];case 4:return o.trys.push([4,6,,7]),t.info("LPC::Sending message to user, message length {0}",l&&l.length),[4,r(i,l)];case 5:return o.sent(),u(!0),s(a.LpcCallbackTelemetryType.lpcQuickIM,c.TeamsMri),[3,7];case 6:return h=o.sent(),v="Failed to send message",t.error(v),u(!1,v),[3,7];case 7:return[2];}});});};};var y=function(e,t,n,r,a,s,l,u,d){return function(p,f){return i(void 0,void 0,void 0,function(){var i,h,v,g,m,y,b,C,S,P,w,T;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,7,,8]),t.info("LPC::Blocking contact"),i=e.scenarios.people.lpcBlockContact,h=p.TeamsMri,v=d.valueAsBoolean(e.settings.names.enableTfwToTfwFederatedInviteFree),[4,s.getAllShortPeopleProfile([h],i,!1,void 0,!0,void 0,!1)];case 1:return g=o.sent()[0],m=a.isCurrentUserTFLOrMsaAccount(),y=g.type,(b=c.isMixedChatUserinTFW(y,m,e.userTypes.tflConsumer))&&(h=p.TeamsMri.replace("8:","8:tfl:")),[4,n.getConversationWithV2(h,"LivePersonaCard")];case 2:return(C=o.sent())?[4,l.acceptBlockChat(C.id,!1)]:[3,4];case 3:return o.sent(),[3,6];case 4:return[4,r.addBlockedMri(p.TeamsMri,"LivePersonaCard")];case 5:o.sent(),o.label=6;case 6:return f(!0),u(c.getBlockTelemetryType(m,y,v),h,c.getTelemetryDatabag(m,g,e,null===(T=null===(w=null===C||void 0===C?void 0:C.memberProperties)||void 0===w?void 0:w.relationshipState)||void 0===T?void 0:T.edRedemptionRequired)),[3,8];case 7:return S=o.sent(),P="Failed to block contact",t.error(P),f(!1,P),[3,8];case 8:return[2];}});});};},b=function(e,t,n,r,a,s,l,u){return function(d,p){return i(void 0,void 0,void 0,function(){var i,f,h,v,g,m,y,b,C,S,P,w;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,7,,8]),t.info("LPC::Unblocking contact"),i=e.scenarios.people.lpcUnblockContact,f=d.TeamsMri,h=u.valueAsBoolean(e.settings.names.enableTfwToTfwFederatedInviteFree),[4,s.getAllShortPeopleProfile([f],i,!1,void 0,!0,void 0,!1)];case 1:return v=o.sent()[0],g=a.isCurrentUserTFLOrMsaAccount(),m=v.type,(y=c.isMixedChatUserinTFW(m,g,e.userTypes.tflConsumer))&&(f=d.TeamsMri.replace("8:","8:tfl:")),[4,n.getConversationWithV2(f,"LivePersonaCard")];case 2:return(b=o.sent())?[4,n.acceptBlockChat(b.id,!0,"LivePersonaCard")]:[3,4];case 3:return o.sent(),[3,6];case 4:return[4,r.deleteBlockedMri(d.TeamsMri,"LivePersonaCard")];case 5:o.sent(),o.label=6;case 6:return p(!0),l(c.getUnblockTelemetryType(g,m,h),f,c.getTelemetryDatabag(g,v,e,null===(w=null===(P=null===b||void 0===b?void 0:b.memberProperties)||void 0===P?void 0:P.relationshipState)||void 0===w?void 0:w.edRedemptionRequired)),[3,8];case 7:return C=o.sent(),S="Failed to unblock contact",t.error(S),p(!1,S),[3,8];case 8:return[2];}});});};},C=function(e,t,n,r,s){return function(c,l){return i(void 0,void 0,void 0,function(){var i,u,d,p;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e.info("LPC::Edit Me Profile"),[4,r.getMeMSAProfile(n.scenarios.people.lpcEditProfile,!1)];case 1:return i=o.sent(),u=n.appHeaderBar.buttonid.profileButton,t.open(n.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[u],user:i,isMSAEditNameClick:!0}),l(!0),s(a.LpcCallbackTelemetryType.lpcEditMeProfile,c.TeamsMri),[3,3];case 2:return d=o.sent(),p="Failed to edit me user profile",e.error(p),l(!1,p),[3,3];case 3:return[2];}});});};},S=function(e,t,n,r,s){if(n.valueAsBoolean(r.settings.names.enableManageAliasPrivacy))return function(n,c){return i(void 0,void 0,void 0,function(){var i;return o(this,function(o){try{e.info("LPC::Manage discoverability settings"),t.open(r.dialogs.manageAliasPrivacyDialog,{backButtonShouldOpenSettings:!0}),c(!0),s(a.LpcCallbackTelemetryType.lpcManageDiscoverabilitySettings,n.TeamsMri);}catch(t){i="Failed to manage discoverability settings",e.error(i),c(!1,i);}return[2];});});};},P=function(e,t,n,r){if(n.valueAsBoolean(r.settings.names.enableAliasVisibilitySettings))return function(n){try{e.info("LPC::Manage alias visibility settings"),t.open(r.dialogs.manageAliasVisibilityDialog,{backButtonShouldOpenSettings:!0,referrer:r.manageAliasVisibilityDialogReferrer.lpcMeProfileCard}),n(!0);}catch(t){var i="Failed to open the Manage alias visibility settings dialog";e.error(i),n(!1,i);}};},w=function(e,t,n,r){return function(s){return i(void 0,void 0,void 0,function(){var i,c,l;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e.info("LPC::Open meeting details"),i=s.replace(/\//g,"-"),[4,n.navigateToCalendarScheduleForm(t.dialogs.meetingDetail,{slug:i,eventId:i,providerType:services.CalendarEventProviderType.userEventUsingEventId,navCtx:t.navContext.livePersonaCard})];case 1:return o.sent(),r(a.LpcCallbackTelemetryType.lpcOpenMeetingDetails,i),[3,3];case 2:throw c=o.sent(),l="Error opening meeting details",e.error(l),l;case 3:return[2];}});});};},T=function(e,t,n,r){return function(s,c,l){return i(void 0,void 0,void 0,function(){var i,u;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,5,,6]),e.info("LPC::Open conversation"),!Boolean(s)||!Boolean(c))throw new Error("clientThreadId and internetMessageId cannot be nullish.");return l?[4,n.navigateToChat(c,t.navigation.context.chat)]:[3,2];case 1:return o.sent(),[3,4];case 2:return[4,n.navigateToChannel(s,t.navigation.context.channel,null,c)];case 3:o.sent(),o.label=4;case 4:return r(a.LpcCallbackTelemetryType.lpcOpenConversation,c),[3,6];case 5:throw i=o.sent(),u="Error opening conversation details",e.error(u),u;case 6:return[2];}});});};},k=function(e,t,n,r){return function(a,s){return i(void 0,void 0,void 0,function(){var i,l,u,d,p,f,h,v;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e.info("LPC::Navigate to {0} within the card",a),(i=c.getTelemetryTypeFromLpcCardView(a))?(l=n.getFreshnessInMs(),u=t.scenarios.people.lpcSignalInternalNavigation,d=s.TeamsMri,p=s.Upn,[4,n.getAllShortPeopleProfile([d||p],u,!Boolean(d),void 0,!0,void 0,!0)]):(e.warn("LPC::Navigate to unsupported {0} within the card",a),[2]);case 1:return f=o.sent()[0],d=f.mri,r(i,d),[3,3];case 2:return h=o.sent(),v="Error in logging the LPC internal event navigating to "+a,e.error(v),[3,3];case 3:return[2];}});});};};t.LPCActionCallbackFactory=function(e,n,r,i,o,a,s,c,l,A,I,L,O,E,U){var x=u(n,e,s),M=d(o,c),D=p(o,l);return{startChat:f(n,r,i,o,a,x,E),showOrgChart:h(n,r,i,x,E,U),showLinkedIn:v(n,r,i,o,x,E),sendQuickMessage:t.makeSendQuickMessage(n,r,i,D,E),startVideoCall:m(n,r,i,M,E),startAudioCall:g(n,r,i,M,E),blockContact:y(n,r,o,A,a,i,O,E,L),unblockContact:b(n,r,o,A,a,i,E,L),editMeProfile:C(r,I,n,i,E),manageDiscoverabilitySettings:S(r,I,L,n,E),openAliasVisibilitySettings:P(r,I,L,n),openMeetingAsync:w(r,n,s,E),openTeamsConversationAsync:T(r,n,s,E),signalInternalNavigationAsync:k(r,n,i,E)};};},2408:function(e,t,n){"use strict";function r(e,t){return{disableChatFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartChatHeaderButton),disableOrgChartFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcOrgChartHeaderButton),disableVideoFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartVideoCallHeaderButton),disableAudioCallFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartAudioCallHeaderButton)};}function i(e){return e&&validator.isEmail(e);}function o(e,t,n){var r=this;return function(i,o,a){return u(r,void 0,void 0,function(){var r,o,s,c,l,u;return d(this,function(d){switch(d.label){case 0:r=t.service.newScenario(n.scenarios.people.lpcGetOrgChart),o=i.TeamsMri||i.Smtp||i.Upn,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,e.getOrgChart(o,n.scenarios.people.lpcCallerName)];case 2:return(s=d.sent())?(c=h.getDirectReportsAndManager(s.value),r.stop(),a(c,void 0)):(u="No orgChart returned",t.error(u),r.stop({reason:u}),a(void 0,u)),[3,4];case 3:return l=d.sent(),u="Exception in orgChart call",t.error("getOrgChart failed in LPC data callback"),r.fail({reason:u}),a(void 0,u),[3,4];case 4:return[2];}});});};}function a(e,t,n,r){var i=this;return function(o,a){return u(i,void 0,void 0,function(){var i,s,c,l,u,p,f,v;return d(this,function(d){switch(d.label){case 0:if(!t.valueAsBoolean(r.settings.names.enableFetchOrgchartProfilesFromHost))return a(void 0,"enableFetchOrgchartProfilesFromHost flag is set to false"),[2];if(!o||0===o.length)return a(void 0,"list of identifiers should not be empty"),[2];i=n.service.newScenario(r.scenarios.people.lpcGetPersonaProfiles),d.label=1;case 1:return d.trys.push([1,3,,4]),s=h.getUpnOrSmtpListFromPersonaIdentifiersList(o),[4,e.getAllShortPeopleProfile(s,r.scenarios.people.lpcGetPersonaProfiles,!0)];case 2:return(c=d.sent())&&0!==c.length?(u=c.map(function(e){return{displayName:e.displayName,department:e.department,jobTitle:e.jobTitle,upn:e.userPrincipalName,teamsMri:e.mri,aadObjectId:e.objectId};}),a(u,void 0),[3,4]):(l="People profiles not found",n.error(l),i.stop({reason:l}),a(void 0,l),[2]);case 3:return p=d.sent(),f=teamspace.services.AppsServiceUtils.getSafeError(p),v="getPeopleProfilesCallback(): Failed with error: "+f.message,n.error(v),i.fail({errorMessage:f.message,errorCode:f.errorCode}),a(void 0,v),[3,4];case 4:return[2];}});});};}function s(e,t,n,r,i,o,a){var s=this;return function(c,l,p){return u(s,void 0,void 0,function(){var s,l,u,g,m,y,b,C,S,P,w,T,k,A,I,L,O,E,U,M,D,F,B;return d(this,function(d){switch(d.label){case 0:if(s=t.service.newScenario(i.scenarios.people.lpcGetHeaderInfo),c.TopicId)return l={cardType:"Topic",headerInfo:{userHeaderInfo:{}}},s.stop(),p(l,void 0),[2];u=c.TeamsMri||c.Smtp||c.Upn,d.label=1;case 1:return d.trys.push([1,8,,9]),g=f.deserializeHostAppPersonaId(c.HostAppPersonaId),m=g.isSharedChannel,y=g.hostTenantId,b=g.hostConversationId,C=g.isExchangeOnlyContact,S=void 0,m?[4,e.getAllPeopleProfileForConversation([u],b,!1,i.scenarios.people.lpcGetHeaderInfoSC,void 0,m,y)]:[3,3];case 2:return S=d.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfoSC),[3,7];case 3:return C?[4,h.getPersonaProfileByContactId(c.OlsPersonaId,t,o,s,i.scenarios.people.lpcGetHeaderInfoEC)]:[3,5];case 4:return(S=d.sent())?[3,7]:[2,p(void 0,"No profile returned for exchange contact in LPC getHeaderInfoAndCardType callback")];case 5:return[4,e.getAllPeopleProfile([u],i.scenarios.people.lpcGetHeaderInfo,!Boolean(c.TeamsMri))];case 6:S=d.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfo),d.label=7;case 7:return(P=S[0])?(w=P,T=n.getCurrentSkypeMri(),k=T===c.TeamsMri,A=SkypeX.Services.ChatServiceUtils.isAnonymousUserMri(c.TeamsMri),I=f.determineCardTypeForTargetUser(w.role,w.type,k,A,i),L=r.valueAsBoolean(i.settings.names.showOnlySearchablePhonesAndEmailsInLPC),O=a.isCurrentUserTFLOrMsaAccount(),E=h.getIsMixedChatUser(O,w.type),U=m&&w.xtapUser?w.tenantName:void 0,M=v.isExtendedDirectoryUser(w.userType,i),D=x(I,w,L,E,U,m,O,M),s.stop(),p(D,void 0)):(B="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:B}),p(void 0,B)),[3,9];case 8:return F=d.sent(),B="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:B}),p(void 0,B),[3,9];case 9:return[2];}});});};}function c(e,t,n,r,i,o,a){var s=this;return function(c,l){return u(s,void 0,void 0,function(){var s,u,p,g,m,y,b,C,S,P,w,T,k,A,I,L,O,E,U,x,M;return d(this,function(d){switch(d.label){case 0:s=t.service.newScenario(r.scenarios.people.lpcGetPersonaInfo),u=c.TeamsMri||c.Smtp||c.Upn,d.label=1;case 1:return d.trys.push([1,8,,9]),p=f.deserializeHostAppPersonaId(c.HostAppPersonaId),g=p.isSharedChannel,m=p.hostTenantId,y=p.hostConversationId,b=p.isExchangeOnlyContact,C=void 0,g?[4,e.getAllPeopleProfileForConversation([u],y,!1,r.scenarios.people.lpcGetPersonaInfoSC,void 0,g,m)]:[3,3];case 2:return C=d.sent(),s.mark(r.scenarios.people.lpcGetPersonaInfoSC),[3,7];case 3:return b?[4,h.getPersonaProfileByContactId(c.OlsPersonaId,t,i,s,r.scenarios.people.lpcGetPersonaInfoEC)]:[3,5];case 4:return(C=d.sent())?[3,7]:[2,l(void 0,"No profile returned for exchange contact in LPC getPersonaInfo callback")];case 5:return[4,e.getAllPeopleProfile([u],r.scenarios.people.lpcGetPersonaInfo,!Boolean(c.TeamsMri))];case 6:C=d.sent(),s.mark(r.scenarios.people.lpcGetPersonaInfo),d.label=7;case 7:return(S=C[0])?(P=S,w=o.isCurrentUserTFLOrMsaAccount(),T=h.getIsMixedChatUser(w,P.type),k=w&&T,A=v.isExtendedDirectoryUser(P.userType,r),I=n.valueAsBoolean(r.settings.names.showOnlySearchablePhonesAndEmailsInLPC)&&!k,L=n.valueAsBoolean(r.settings.names.enableAliasVisibilitySettings),O=a.getCurrentSkypeMri(),E=O===c.TeamsMri,U={aadObjectId:P.objectId,department:P.department,company:P.companyName||P.tenantName||void 0,displayName:P.displayName,email:L&&w&&E?void 0:h.getEmail(P,I),extraEmails:L?h.getVisibleEmails(P):h.getEmails(P,I),firstName:P.givenName,hostAppPersonaId:c.HostAppPersonaId,isInformationBarrierBarred:P.isIbBarred,isMixedChatUser:T,isExtendedDirectoryUser:A,jobTitle:P.jobTitle,lastName:P.surname,officeLocation:P.userLocation,phoneNumbersAndUrls:L?h.getVisiblePhones(P):h.getPhoneNumbers(P,I),skypeId:P.skypeId,teamsMri:c.TeamsMri||P.mri,upn:P.userPrincipalName,userType:f.determineLPCPersonaType(P,r)},s.stop(),l(U,void 0)):(M="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetPersonaInfo callback"),s.fail({reason:M}),l(void 0,M)),[3,9];case 8:return x=d.sent(),M="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetPersonaInfo callback"),s.fail({reason:M}),l(void 0,M),[3,9];case 9:return[2];}});});};}var l=this&&this.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=__WRAPPED_get(arguments,n);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&__WRAPPED_set(e,i,'=',__WRAPPED_get(t,i));}return e;}).apply(this,arguments);},u=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e);});}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){e.done?n(e.value):i(e.value).then(a,s);}c((r=r.apply(e,t||[])).next());});},d=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t]);};}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue;}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break;}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break;}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break;}a[2]&&c.ops.pop(),c.trys.pop();continue;}n=t.call(e,c);}catch(e){n=[6,e],o=0;}finally{i=a=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1];},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(s,Symbol.iterator,'=',function(){return this;}),s;};Object.defineProperty(t,"__esModule",{value:!0});var p=n(34),f=n(142),h=n(129),v=n(39);t.convertHTMLEntities=function(e,t){return e=t.decodeHtml(e),e=t.replaceNewlines(e),e=e.replace(/=""/g,"");},t.unescapeHtmlEntities=function(e,n){if(!e)return e;var r=document.createElement("textarea"),i=new DOMParser().parseFromString(e,"text/html").body.innerHTML.toString(),o=t.convertHTMLEntities(i,n);return r.textContent=o,r.value;};var g=function(e,t,n,r,o){return function(a,s){return u(void 0,void 0,void 0,function(){var c,u,p,v,g,m,y,b,C,S,P,w,T,k;return d(this,function(d){switch(d.label){case 0:if(c=e.service.newScenario(n.scenarios.people.lpcGetImageUri),u=f.deserializeHostAppPersonaId(a.HostAppPersonaId),p=u.isSharedChannel,v=u.hostTenantId,g=u.hostConversationId,m=u.isExchangeOnlyContact,y={mri:a.TeamsMri,principalName:a.Upn||a.Smtp||a.TeamsMri,displayName:a.DisplayName||"",size:n.profilePictureSizes.medium},b=!1,C=i(y.principalName),S=p&&!C,a.DisplayName&&!S)return[3,9];P=a.TeamsMri||a.Smtp||a.Upn,d.label=1;case 1:return d.trys.push([1,8,,9]),w=void 0,p?[4,r.getAllPeopleProfileForConversation([P],g,!0,n.scenarios.people.lpcGetImageUriSC,void 0,p,v)]:[3,3];case 2:return w=d.sent(),c.mark(n.scenarios.people.lpcGetImageUriSC),[3,7];case 3:return m?[4,h.getPersonaProfileByContactId(a.OlsPersonaId,e,o,c,n.scenarios.people.lpcGetImageUriEC)]:[3,5];case 4:return w=d.sent(),[3,7];case 5:return[4,r.getAllShortPeopleProfile([P],n.scenarios.people.lpcGetImageUri,!Boolean(a.TeamsMri))];case 6:w=d.sent(),c.mark(n.scenarios.people.lpcGetImageUri),d.label=7;case 7:return(T=w[0])&&(y=l(l({},y),{displayName:T.displayName}),S&&(y=l(l({},y),{principalName:T.userPrincipalName})),T.isIbBarred&&(b=!0)),[3,9];case 8:return k=d.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,9];case 9:return p&&(y=l(l({},y),{isSharedChannel:p,hostTenantId:v,conversationId:g})),m&&(y=l(l({},y),{isExchangeOnlyContact:m})),y=l(l({},y),{isExternalUser:"External"===a.PersonaType,isGuestUser:"Guest"===a.PersonaType}),t.loadImage(y,!1,b,!1,p?n.scenarios.people.lpcGetImageUriSC:n.scenarios.people.lpcGetImageUri).then(function(e){var t=e&&e.imgUrl||"";c.stop(),s(t,{});}).catch(function(e){c.fail({reason:"Failed to fetch persona"}),s(void 0,void 0,e);}),[2];}});});};};t.getSkypeConsumerChatStatus=function(e,t,n,r){return u(void 0,void 0,void 0,function(){var i,o,a,s;return d(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,t.findConversationWith(n)];case 1:return(i=c.sent())&&i.isSfC()?(o=i.InteropConversationStatus())===e.interopConversationStatus.blocked?[2,p.PersonaPresence.blocked]:[2,p.PersonaPresence.none]:[2,void 0];case 2:return a=c.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(a),r.debug("getSkypeConsumerChatStatus(): Failed to get skype consumer chat status with error "+s),[2,void 0];case 3:return[2];}});});};var m=function(e,n,r,i,o,a,s){return u(void 0,void 0,void 0,function(){var c,l,u,f;return d(this,function(d){switch(d.label){case 0:return[4,t.getSkypeConsumerChatStatus(r,i,a,s)];case 1:if(void 0!==(c=d.sent()))return[2,c];if(l=o.isBlockedContact(a))return[2,p.PersonaPresence.blocked];if(u=e.status,f=e.flwPresence,n.valueAsBoolean(r.settings.names.enableFlwPresence)){if(f===SkypeX.Services.UserFlwPresence.OffShift)return[2,p.PersonaPresence.offline];if(f===SkypeX.Services.UserFlwPresence.OnShift)switch(u){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return[2,p.PersonaPresence.busy];default:return[2,p.PersonaPresence.online];}}switch(u){case SkypeX.Services.UserStatus.Online:return[2,p.PersonaPresence.online];case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return[2,p.PersonaPresence.offline];case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return[2,p.PersonaPresence.away];case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return[2,p.PersonaPresence.busy];case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return[2,p.PersonaPresence.dnd];default:return[2,p.PersonaPresence.offline];}return[2];}});});},y=function(e,t,n,r,i,o,a){if(!t||0===t.length)return e;var s=r.getLocalTimezone();if(n&&s!==n){var c=new Date().toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),l=c.length>0?c[c.length-1]:null;l&&(t=o.instant(a.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:l}));}return o.instant(a.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t});},b=function(e,t,n,r,i,o,a,s,c){var l=e.status,u=e.calendarData,d=e.lastSeenAt,p=e.flwPresence,f=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(p===SkypeX.Services.UserFlwPresence.OffShift)return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(p===SkypeX.Services.UserFlwPresence.OnShift){var h=void 0,v=void 0,g=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(f);switch(g&&g.currentShift&&(h=c.getDate(new Date(g.currentShift.endTime),"shortTime"),v=g.currentShift.teamOlsonCode),l){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var m=r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return y(m,h,v,s,c,r,o);default:var b=n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return y(b,h,v,s,c,r,o);}}}var C=d&&new Date().getTime()-d.getTime()<=i.timeInMiliseconds.year;if(u&&u.isOutOfOffice)switch(l){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return C?r.instant(o.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:a.transformIntoTimeago(d)}):n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);}else switch(l){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return C?r.instant(o.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:a.transformIntoTimeago(d)}):n.GetTranslatedStatusText(l);default:return n.GetTranslatedStatusText(l);}},C=function(e,t,n,r,i){var o="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(o=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),o;},S=function(e,t,n,r,i,o){var a={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var l=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(l);}if(s){var u=r.stripHtml(i.sanitizeHtml(s)).trim(),d=C(e,0,0,r,i);u.length&&!d.length&&(a.message=u);}}return a.message&&a.publishTime?a:void 0;},P=function(e,n,r,i){var o=[],a=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===n.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=e.decodeHtml(i.attribs["data-itemprops"]),l=h.removeZeroWidthSpace(c),u=JSON.parse(l).mri;o.push({text:t.unescapeHtmlEntities(s,e),hostAppPersonaId:u,mri:u});}else"text"===i.type?o.push({text:t.unescapeHtmlEntities(r.DomUtils.getText(i),e),hostAppPersonaId:void 0}):"br"===i.name?o.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&a(i.children);});};return a(i),o;},w=function(e,t,n,r,i,o){if(t.valueAsBoolean(n.settings.names.enableStatusNoteV2)&&e.note){var a={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var l=i.sanitizeHtml(s).trim(),u=window.htmlparser2,d=u.parseDOM("<div>"+l+"</div>"),p=P(r,n,u,d);a.message=p;}if(c&&c.trim()){var f=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(f);}return a.message.length&&a.publishTime?a:void 0;}},T=function(e){var t;return t=e&&__WRAPPED_get(e,'location')?__WRAPPED_get(e,'location'):__WRAPPED_get(SkypeX.Services.PresenceWorkLocation,SkypeX.Services.PresenceWorkLocation.Unknown),{location:t};},k=function(e,t,n,r,i,o,a,s,c,l,p,f,h,v,g){return function(y,P){return u(void 0,void 0,void 0,function(){var u,k,A;return d(this,function(d){switch(d.label){case 0:return u=e.getPresence(y,P),A={},[4,m(u,i,o,h,v,y,g)];case 1:return A.presence=d.sent(),A.isOutOfOffice=u&&!!u.calendarData&&!!u.calendarData.isOutOfOffice,A.oofMessage=u&&C(u,0,0,t,n),A.presenceText=u&&b(u,i,a,s,o,c,l,p,f),A.statusNote=u&&S(u,0,0,t,n,r),A.statusNoteV2=u&&w(u,i,o,t,n,r),A.workLocation=T(u),k=A,[2,k];}});});};},A=function(e,t,n,r){return function(i){return u(void 0,void 0,void 0,function(){var o,a,s,c,l,u;return d(this,function(d){switch(d.label){case 0:o=t.getRootRouteParams(),a=o&&o.ctx===n.navigation.context.chat&&o.slug,d.label=1;case 1:return d.trys.push([1,6,,7]),a?[4,e.getConversation(o.slug)]:[3,3];case 2:(s=d.sent())&&!s.isOneOnOne()&&(s=void 0),d.label=3;case 3:return(c=s)?[3,5]:[4,e.findConversationWith(i)];case 4:c=d.sent(),d.label=5;case 5:return(s=c)&&s.isInteropChat()?[2,Promise.resolve(SkypeX.Services.PresenceSource.SFB)]:[2,Promise.resolve(SkypeX.Services.PresenceSource.UPS)];case 6:return l=d.sent(),u=teamspace.services.AppsServiceUtils.getSafeError(l),r.debug("getPresenceSourceInternal(): Failed to get presence with error "+u),[2,Promise.resolve(SkypeX.Services.PresenceSource.UPS)];case 7:return[2];}});});};},I=function(e,t,n,r,i,o,a,s,c,l,p,h,v,g,m,y,b){return function(C,S){return u(void 0,void 0,void 0,function(){var u,P,w,T,I,L,O,E,U,x;return d(this,function(d){switch(d.label){case 0:if(u=f.deserializeHostAppPersonaId(C.HostAppPersonaId).isExchangeOnlyContact)return[2,S(null,void 0)];P=a.scenarios.people.lpcGetRichPresence,w=b.service.newScenario(P),d.label=1;case 1:return d.trys.push([1,5,,6]),T=A(e,m,a,b),I=k(t,n,r,i,o,a,s,c,l,p,h,v,e,g,b),[4,f.resolveMriIfNeeded(C,y,P)];case 2:return L=d.sent(),[4,T(L)];case 3:return O=d.sent(),[4,I(L,O)];case 4:return E=d.sent(),w.stop(),S(E,void 0),[3,6];case 5:return U=d.sent(),w.fail(),x=teamspace.services.AppsServiceUtils.getSafeError(U),S(void 0,"getPresenceCallback(): Failed to execute presence callback with error "+x),[3,6];case 6:return[2];}});});};},L=function(e,t,n,i,o,a,s,c,l,p,g,m,y,b,C){return function(S){return u(void 0,void 0,void 0,function(){var u,P,w,T,k,A,I,L,E,U,x,M,D,F,B,_,R,N,G,H,j,V,X,z,W,q,Q,K,Z,J,$,Y,ee,te,ne,re,ie,oe,ae,se,ce,le,ue,de,pe,fe,he,ve,ge,me,ye,be,Ce,Se,Pe;return d(this,function(d){switch(d.label){case 0:return u=o.scenarios.people.lpcGetHeaderActionsPolicy,P=i.service.newScenario(u),w=l.getCurrentSkypeMri(),[4,f.resolveMriIfNeeded(S,n,u)];case 1:return T=d.sent(),k=w===T,A=m.valueAsBoolean(o.settings.names.msgEnableSelfChat),I=m.valueAsBoolean(o.settings.names.enableExpandedViewInLPC),L=f.deserializeHostAppPersonaId(S.HostAppPersonaId),E=L.isSharedChannel,U=L.hostTenantId,x=L.hostConversationId,M=L.isExchangeOnlyContact,D=m.valueAsBoolean(o.settings.names.enableSurvivabilityV2),F=!!D&&!(null===C||void 0===C?void 0:C.isOnline),k&&!A||M?(k?P.stop({reason:"User is me"}):P.stop({reason:"Out-of-tenant outlook Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!I}]):[4,b.isPersonReachable(T)];case 2:if(B=!d.sent())return P.stop({reason:"ED only policy enabled, but user is not in Extended Directory"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!0}];_=!c.isCurrentUserTFLOrMsaAccount(),R={disableChat:!1,disableOrg:!0,disableCall:!1,disableVideo:F,disableBlockUnblock:_,disableLinkedIn:!0},N=s.isBlockedContact(T),G=r(m,o),H=G.disableChatFromKillSwitch,j=G.disableOrgChartFromKillSwitch,V=G.disableVideoFromKillSwitch,X=G.disableAudioCallFromKillSwitch,z=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),R.disableCall=X||!z||k,R.disableVideo=R.disableVideo||V||!z||k,W=t.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),q=y.getSettingValue(SkypeX.Services.TenantSettingsStorageKey.isOrganizationTabEnabled),d.label=3;case 3:return d.trys.push([3,14,,15]),Q=void 0,E?[4,n.getAllPeopleProfileForConversation([T],x,!1,o.scenarios.people.lpcGetHeaderActionsPolicySC,void 0,E,U)]:[3,5];case 4:return Q=d.sent(),P.mark(o.scenarios.people.lpcGetHeaderActionsPolicySC),[3,7];case 5:return[4,n.getAllPeopleProfile([T],o.scenarios.people.lpcGetHeaderActionsPolicy,!T)];case 6:Q=d.sent(),P.mark(o.scenarios.people.lpcGetHeaderActionsPolicy),d.label=7;case 7:return(K=Q[0])?(Z=K.featureSettings,J=K.type,$=K.userType,Y=K.isAnonymousUser,ee=K.mri,te=K.isIbBarred,ne=K.isFederated,Y||te?(Y?P.stop({reason:"Anonymous User"}):P.stop({reason:"IB Barred User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!0}]):(re=c.isCurrentUserTFLOrMsaAccount(),ie=h.getIsMixedChatUser(re,K.type),oe=m.valueAsBoolean(o.settings.names.disableAcsOutgoingCallbackEntryPoints),ae=SkypeX.Services.ChatServiceUtils.isCallingButtonsEnabled({userMri:S.TeamsMri,disableAcsOutgoingCallbackEntryPointsFF:oe}).isAudioButtonEnabled,se=K.type===h.PersonaType.SkypeConsumer,ce=m.valueAsBoolean(o.settings.names.enableTfwToTfwFederatedInviteFree),le=!h.shouldEnableBlockUnblock({isMe:k,isAnonymousUser:Y,isLoggedInUserConsumer:re,personaProfile:K,isTfwToTfwFederatedInviteFreeEnabled:ce}),R.disableBlockUnblock=le,N?(P.stop({reason:"Blocked Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:le,disableLinkedIn:!0}]):(ue=m.valueAsBoolean(o.settings.names.enableExtendedDirectory))&&v.isExtendedDirectoryUser(null===K||void 0===K?void 0:K.userType,o)?(P.stop({reason:"Extended Directory user"}),[2,O({disableChat:!1,disableOrg:!0,disableCalling:!0,disableBlockUnblock:!0,disableLinkedIn:!0,settingsService:m,constants:o,messagingPolicySettingsStore:t,featureSettings:Z})]):se?[2,O({disableChat:!1,disableOrg:!0,disableCalling:!1,disableBlockUnblock:!1,disableLinkedIn:!I,settingsService:m,constants:o,messagingPolicySettingsStore:t,featureSettings:Z,isAppInOfflineMode:F})]:ie?[2,O({disableChat:!1,disableOrg:!0,disableCalling:!0,disableBlockUnblock:!1,disableLinkedIn:!I,settingsService:m,constants:o,messagingPolicySettingsStore:t,featureSettings:Z})]:ae?(de=SkypeX.Services.ChatServiceUtils.isPstnMri(ee))?(P.stop({reason:"PSTN User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:X||!1,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!0}]):(pe=Z&&Z.isPrivateChatEnabled,fe=J&&J.toLowerCase()===o.userTypes.person.toLowerCase(),he=$&&$.toLowerCase()===o.userTypes.guest.toLowerCase(),ve=a===teamspace.services.UserTypeInTenant.Guest,ge=SkypeX.Services.ChatServiceUtils.isSFBMri(ee),me=ne||J&&J.toLowerCase()===o.userTypes.federated.toLowerCase(),R.disableChat=H||!1===pe||!W,R.disableOrg=j||!(fe&&!he)||ve||!q,R.disableLinkedIn=(me||ge)&&!I,R.disableChat?[3,12]:[4,p.getChatConversationWith(ee)]):[2,O({disableChat:!1,disableOrg:!0,disableCalling:!0,disableBlockUnblock:!1,disableLinkedIn:!I,settingsService:m,constants:o,messagingPolicySettingsStore:t,featureSettings:Z})])):[3,13];case 8:if(!(ye=d.sent())||SkypeX.Services.SkypeConversationLocal.isLie(ye.id))return[3,12];d.label=9;case 9:return d.trys.push([9,11,,12]),[4,g.validateUpgradePolicyOfChatRecipient(ye.id,!1)];case 10:return be=d.sent(),Ce=be&&be.isValidChat,R.disableChat=!Ce,[3,12];case 11:return Se=d.sent(),i.error("Failed to validate chat in LPC data callbacks"),[3,12];case 12:P.stop(),d.label=13;case 13:return[3,15];case 14:return Pe=d.sent(),P.fail({reason:"Error while fetching persona"}),i.error("Failed to fetch persona profile in LPC data callbacks"),[3,15];case 15:return[2,R];}});});};},O=function(e){var t=e.disableChat,n=e.disableOrg,i=e.disableCalling,o=e.disableBlockUnblock,a=e.disableLinkedIn,s=e.settingsService,c=e.constants,l=e.messagingPolicySettingsStore,u=e.featureSettings,d=e.isAppInOfflineMode,p=r(s,c),f=p.disableChatFromKillSwitch,h=p.disableOrgChartFromKillSwitch,v=p.disableVideoFromKillSwitch,g=p.disableAudioCallFromKillSwitch,m=l.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),y=null===u||void 0===u?void 0:u.isPrivateChatEnabled;return{disableChat:t||Boolean(f)||!m||!1===y,disableOrg:t||n||Boolean(h),disableCall:i||Boolean(g),disableVideo:i||Boolean(v)||d,disableBlockUnblock:o,disableLinkedIn:t||a};},E=function(e,t,n,r,i,o,a,s){var c=h.getEmail(t,n);return{cardType:e,headerInfo:{userHeaderInfo:{displayName:t.displayName,firstName:t.givenName,lastName:t.surname,title:t.jobTitle,department:h.getDepartment({profile:t,isLoggedInUserConsumer:a,isSharedChannel:o,isExtendedDirectoryUser:s}),location:t.userLocation,profilePictureUrl:t.imageUri,mobilePhone:t.mobile,phone:h.getPhoneNumber(t,n),userPrincipalName:t.userPrincipalName,email:c&&c.Address,imAddress:t.skypeId,tenantName:i},isMixedChatUser:r,isExtendedDirectoryUser:s}};},U=function(e,t){return{cardType:e,headerInfo:{unresolvedHeaderInfo:{email:t}}};},x=function(e,t,n,r,i,o,a,s){return"NotResolved"===e?U(e,t.email):E(e,t,n,r,i,o,a,s);};t.makeGetHeaderInfoAndCardTypeCallback=s,t.GetPresenceSourceFunction=A,t.GetRichPresenceFunction=k,t.LPCDataCallbackFactory=function(e,t,n,r,i,l,u,d,p,f,h,v,m,y,b,C,S,P,w,T,k,A,O,E,U,x,M,D){return{getAndPrefetchPersonaImageUri:g(e,C,p,r,U),getRichPresence:I(t,n,i,l,u,d,p,f,h,v,m,y,b,S,O,r,e),getHeaderActionsPolicyAsync:L(P,w,r,e,p,T,S,A,k,t,E,d,x,M,D),getPersonaInfo:c(r,e,d,p,U,A,k),getOrgChart:o(r,e,p),getHeaderInfoAndCardType:s(r,e,k,d,p,U,A),getBatchPersonaProfiles:a(r,d,e,p)};};},2409:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e);});}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){e.done?n(e.value):i(e.value).then(a,s);}c((r=r.apply(e,t||[])).next());});},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t]);};}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue;}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break;}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break;}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break;}a[2]&&c.ops.pop(),c.trys.pop();continue;}n=t.call(e,c);}catch(e){n=[6,e],o=0;}finally{i=a=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1];},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(s,Symbol.iterator,'=',function(){return this;}),s;};Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return function(t,n){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.newSecondPartyOneDsLogger(t,n),[2];});});};},a=function(e){return function(t,n){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.logSecondPartyEvent(t,n),[2];});});};};t.LPCTelemetryCallbackFactory=function(e){return{initializeExternalOneDsTelemetry:o(e),sendExternalOneDsTelemetryEvent:a(e)};};},2410:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2411);t.defaultTheme=r.defaultTheme;var i=n(2412);t.darkTheme=i.darkTheme;var o=n(2413);t.highContrastTheme=o.highContrastTheme;},2411:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34),i="rgba(37,36,36,0.75)",o={themeDarker:"#34365c",themePrimary:i,themeSecondary:i,neutralPrimary:"#252424",neutralSecondary:i,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",whiteTranslucent40:"#808080",purple:"#5B5FC7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)",purpleLight:"#E5E5F1",purpleDark:"#6264a7",neutralDark:"#616161",accent:"#6264a7"};t.defaultTheme={palette:o,semanticColors:{accentButtonBackground:"#5B5FC7",listItemBackgroundHovered:"#FAF9F8",infoIcon:"#5B5FC7",menuItemTextHovered:"#252424",buttonBackgroundHovered:"#f3f2f1"},isInverted:!1,themeName:r.LPCTheme.Default};},2412:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34);t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themeDarker:"#C5CBFA",themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,whiteTranslucent40:"#949494",purple:"#9399f5",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff",purpleLight:"#3D3E66",purpleDark:"#9ea2ff",neutralDark:"#D1D1D1",accent:"#9ea2ff"},t.darkTheme={palette:t.darkThemePalette,semanticColors:{accentButtonBackground:"#9399f5",listItemBackgroundHovered:"#3b3a39",infoIcon:"#9399f5",menuItemTextHovered:"#ffffff",buttonBackgroundHovered:"#201f1f"},isInverted:!0,themeName:r.LPCTheme.Dark};},2413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(34),i="#000000",o="#ffffff",a={themeDarker:"#ffff73",themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:o,neutralSecondary:"#ffffff",neutralLight:i,neutralLighter:o,neutralLighterAlt:o,neutralPrimaryAlt:i,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:i,neutralQuaternary:i,neutralQuaternaryAlt:o,white:i,whiteTranslucent40:"#fff",black:o,purple:"#ffff00",magenta:o,magentaDark:i,purpleLight:"#ffff01",purpleDark:"#000",neutralDark:"#fff",accent:"#1aebff"};t.highContrastTheme={palette:a,semanticColors:{accentButtonBackground:"#ffffff",listItemBackgroundHovered:"#ffff00",infoIcon:"#000000",inputBorder:"1px solid #ffffff",menuItemTextHovered:"#000000",buttonBackgroundHovered:"#1aebff"},isInverted:!0,themeName:r.LPCTheme.HighContrast};},2414:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e);});}return new(n||(n=Promise))(function(n,o){function a(e){try{c(r.next(e));}catch(e){o(e);}}function s(e){try{c(r.throw(e));}catch(e){o(e);}}function c(e){e.done?n(e.value):i(e.value).then(a,s);}c((r=r.apply(e,t||[])).next());});},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t]);};}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue;}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break;}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break;}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break;}a[2]&&c.ops.pop(),c.trys.pop();continue;}n=t.call(e,c);}catch(e){n=[6,e],o=0;}finally{i=a=0;}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0};}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1];},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&__WRAPPED_set(s,Symbol.iterator,'=',function(){return this;}),s;};Object.defineProperty(t,"__esModule",{value:!0});var o=teamspace.components.PanelActionGesture,a=teamspace.components.PanelActionOutcome,s=teamspace.components.PanelActionScenario,c=teamspace.components.PanelActionScenarioType,l=teamspace.components.PanelModuleName,u=teamspace.components.PanelModuleType,d=teamspace.components.WorkLoad,p=teamspace.components.SubWorkLoad,f=teamspace.PanelType,h=n(34),v=(function(){function e(e,t,n){this.analyticsService=e,this.loggingService=t,this.conversationsAsyncService=n;}return e.prototype.logPanelActionEvent=function(e,t,n){return r(this,void 0,void 0,function(){var r,v,g,m,y,b,C,S,P,w,T,k,A,I,L,O=this;return i(this,function(i){switch(i.label){case 0:switch(b=u.people,S=a.nav,P=a.nav,w=teamspace.PanelRegion.popover,T=d.chatContent,k=p.composeMsg,e){case h.LpcCallbackTelemetryType.lpcAudioCall:v=o.click,g=s.navCalling,m=l.lpcAudioCall,r="lpcAudioCall";break;case h.LpcCallbackTelemetryType.lpcStartChat:v=o.click,g=s.navChat,m=l.lpcStartChat,r="lpcStartChat";break;case h.LpcCallbackTelemetryType.lpcOrgChart:v=o.click,g=s.orgChart,m=l.lpcOrgChart,r="lpcOrgChart";break;case h.LpcCallbackTelemetryType.lpcOpenMeetingDetails:v=o.click,g=s.navMeetings,m=l.viewMeeting,r="lpcOpenMeeting";break;case h.LpcCallbackTelemetryType.lpcQuickIM:v=o.click,S=a.submit,P=a.submit,g=s.quickIM,m=l.lpcQuickIM,y=l.sendButton,C=u.compose,r="lpcQuickIM";break;case h.LpcCallbackTelemetryType.lpcVideoCall:v=o.click,g=s.navCalling,m=l.lpcVideoCall,r="lpcVideoCall";break;case h.LpcCallbackTelemetryType.lpcBlockContact:v=o.click,g=s.blockUser,m=l.lpcBlockContact,r="lpcBlockContact";break;case h.LpcCallbackTelemetryType.lpcUnblockContact:v=o.click,g=s.unblockUser,m=l.lpcUnblockContact,r="lpcUnblockContact";break;case h.LpcCallbackTelemetryType.lpcLinkedIn:v=o.click,g=s.navLinkedIn,m=l.lpcLinkedIn,r="lpcLinkedIn";break;case h.LpcCallbackTelemetryType.lpcBlockTfwToTfwFederatedUser:g=s.blockUser,m=l.lpcBlockContact,b=u.blockButton,S=a.submit,v=o.click,T=void 0,k=void 0,A=f.livePersonaCard;break;case h.LpcCallbackTelemetryType.lpcUnblockTfwToTfwFederatedUser:g=s.unblockUser,m=l.lpcUnblockContact,b=u.unblockButton,S=a.submit,v=o.click,T=void 0,k=void 0,A=f.livePersonaCard;break;default:return[2];}return L={action:{gesture:v,outcome:S,outcomeNew:P,scenario:g||null,scenarioType:c.people,workLoad:T||null,subWorkLoad:k||null},module:{name:(null===m||void 0===m?void 0:m.toString())||null,nameNew:y?teamspace.shared.AttributeHelper.tryGetEnum(y.toString(),l,this.loggingService):null,type:b||null,typeNew:C?teamspace.shared.AttributeHelper.tryGetEnum(C.toString(),u,this.loggingService):null,summary:r},panel:{type:A?__WRAPPED_get(f,A):null}},[4,this.getTargetThreadType(t)];case 1:return L.targetThread=i.sent(),L.dataBag=n,I=L,this.analyticsService.getAnalyticsPanelActionEventData(I,w).then(function(e){O.analyticsService.sendPanelAction(e);}),[2];}});});},e.prototype.getTargetThreadType=function(e){return r(this,void 0,void 0,function(){var t,n,r,o;return i(this,function(i){switch(i.label){case 0:if(!e)return[2,null];t="OneOnOneChat",i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.conversationsAsyncService.getConversation(e)];case 2:return n=i.sent(),t=n&&n.conversationType||t,[3,5];case 3:return r=i.sent(),o=teamspace.services.AppsServiceUtils.getSafeError(r),this.loggingService.error("getTargetThreadType(): Failed to get conversation with error "+JSON.stringify(o)),[3,5];case 4:return[2,{type:t}];case 5:return[2];}});});},e;}());t.LpcTelemetryHelper=v;}},[2404]);